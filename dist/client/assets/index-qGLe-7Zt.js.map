{"version":3,"file":"index-qGLe-7Zt.js","sources":["../../../src/client/game/scenes/Boot.ts","../../../src/client/game/scenes/GameOver.ts","../../../src/client/game/config/GameConstants.ts","../../../src/client/game/audio/AudioManager.ts","../../../src/client/game/input/InputManager.ts","../../../src/client/game/platform/PlatformManager.ts","../../../src/client/game/config/NoteMapping.ts","../../../src/client/game/audio/ChordDetector.ts","../../../src/client/game/ui/SynthControlPanel.ts","../../../src/client/game/scenes/MuseRunnerGame.ts","../../../src/client/game/scenes/MainMenu.ts","../../../src/client/game/scenes/Preloader.ts","../../../src/client/game/main.ts","../../../src/client/main.ts"],"sourcesContent":["import { Scene } from \"phaser\";\n\nexport class Boot extends Scene {\n  constructor() {\n    super(\"Boot\");\n  }\n\n  preload() {\n    //  The Boot Scene is typically used to load in any assets you require for your Preloader, such as a game logo or background.\n    //  The smaller the file size of the assets, the better, as the Boot Scene itself has no preloader.\n\n    // REMOVED: Background image that was persisting behind the game\n    // this.load.image(\"background\", \"assets/bg.png\");\n  }\n\n  create() {\n    this.scene.start(\"Preloader\");\n  }\n}\n","import { Scene } from \"phaser\";\nimport * as Phaser from \"phaser\";\n\nexport class GameOver extends Scene {\n  camera: Phaser.Cameras.Scene2D.Camera;\n  background: Phaser.GameObjects.Image;\n  gameOverText: Phaser.GameObjects.Text;\n\n  constructor() {\n    super(\"GameOver\");\n  }\n\n  create() {\n    // Configure camera\n    this.camera = this.cameras.main;\n    this.camera.setBackgroundColor(0xff0000);\n\n    // Background – create once, full-screen\n    this.background = this.add\n      .image(0, 0, \"background\")\n      .setOrigin(0)\n      .setAlpha(0.5);\n\n    // \"Game Over\" text – created once and scaled responsively\n    this.gameOverText = this.add\n      .text(0, 0, \"Game Over\", {\n        fontFamily: \"Arial Black\",\n        fontSize: \"64px\",\n        color: \"#ffffff\",\n        stroke: \"#000000\",\n        strokeThickness: 8,\n        align: \"center\",\n      })\n      .setOrigin(0.5);\n\n    // Initial responsive layout\n    this.updateLayout(this.scale.width, this.scale.height);\n\n    // Update layout on canvas resize / orientation change\n    this.scale.on(\"resize\", (gameSize: Phaser.Structs.Size) => {\n      const { width, height } = gameSize;\n      this.updateLayout(width, height);\n    });\n\n    // Return to Main Menu on tap / click\n    this.input.once(\"pointerdown\", () => {\n      this.scene.start(\"MainMenu\");\n    });\n  }\n\n  private updateLayout(width: number, height: number): void {\n    // Resize camera viewport to prevent black bars\n    this.cameras.resize(width, height);\n\n    // Stretch background to fill entire screen\n    if (this.background) {\n      this.background.setDisplaySize(width, height);\n    }\n\n    // Compute scale factor (never enlarge above 1×)\n    const scaleFactor = Math.min(Math.min(width / 1024, height / 768), 1);\n\n    // Centre and scale the game-over text\n    if (this.gameOverText) {\n      this.gameOverText.setPosition(width / 2, height / 2);\n      this.gameOverText.setScale(scaleFactor);\n    }\n  }\n}\n","// Type aliases for better readability\nexport type GameKey = \"S\" | \"D\" | \"F\" | \"G\" | \"H\" | \"J\" | \"K\" | \"R\" | \"U\" | \"I\" | \"A\" | \"L\" | \";\" | \"'\";\n\n// Centralized game configuration constants\nexport const GAME_CONSTANTS = {\n  // Character configuration\n  CHARACTER: {\n    SPEED: 100,\n    WIDTH: 30,\n    HEIGHT: 40,\n    COLOR: 0x3498db,\n    VISUAL_FEEDBACK_COLOR: 0xf39c12,\n    VISUAL_FEEDBACK_DURATION: 200,\n  },\n\n  // Platform configuration\n  PLATFORMS: {\n    WIDTH: 120,\n    HEIGHT: 20,\n    EXTENSION_DISTANCE: 150,\n    AHEAD_OFFSET: 20,\n    CLEANUP_DISTANCE: 400,\n    MIN_LENGTH: 20, // Minimum platform length for quick taps\n    GROWTH_RATE: 100, // Pixels per second growth rate (matches character speed)\n  },\n\n  // Audio configuration\n  AUDIO: {\n    NOTE_DURATION: 0.5,\n    ATTACK_TIME: 0.01,\n    VOLUME: 0.3,\n  },\n\n  // Game mechanics\n  GAME: {\n    OVER_FALL_DISTANCE: 300,\n    SCORE_PER_PLATFORM: 10,\n    GROUND_OFFSET: 60,\n    CHARACTER_HEIGHT_LERP_SPEED: 0.08,\n    FALL_VELOCITY: 300,\n    CAMERA_DEADZONE_X: 200,\n    CAMERA_DEADZONE_Y: 100,\n    CAMERA_FOLLOW_LERP_X: 0.1,\n    CAMERA_FOLLOW_LERP_Y: 0.1,\n    // GROUND MECHANICS\n    GROUND_GRACE_PERIOD: 1000, // 1 second before score decay starts\n    SCORE_DECAY_RATE: 1, // -1 point per second\n    SCREEN_SHAKE_INTENSITY: 2, // Pixels\n    C2_FREQUENCY: 65.41, // C2 note frequency\n    DISSONANCE_START_TIME: 2000, // 2 seconds before dissonance starts\n  },\n  CHORD_DETECTION: {\n    ACCUMULATION_TIME: 1000, // ms\n    TRIAD_POINTS: 50,\n    SEVENTH_POINTS: 100,\n    POWER_CHORD_POINTS: 25,\n  },\n\n  // Level heights for each key (relative to camera height)\n  LEVEL_HEIGHTS: {\n    S: -80, // C - Ground level offset\n    R: -100, // D# - Between C and D\n    D: -120, // D - Level 2 offset\n    F: -160, // E - Level 3 offset\n    G: -200, // F - Level 4 offset\n    H: -240, // G - Level 5 offset\n    J: -280, // A - Level 6 offset\n    K: -320, // B - Highest level offset\n    // Additional chromatic notes\n    U: -260, // G# - Between G and A\n    I: -300, // Bb - Between A and B\n    // Additional octave keys (same note names for chord detection)\n    A: -40, // B3 (one octave below K)\n    L: -360, // C5 (one octave above S)\n    \";\": -400, // D5 (one octave above D)\n    \"'\": -440, // E5 (one octave above F)\n  } as Record<GameKey, number>,\n\n  // Level colors for each key\n  LEVEL_COLORS: {\n    S: 0xe74c3c, // Red (lowest)\n    D: 0xf39c12, // Orange\n    F: 0xf1c40f, // Yellow\n    G: 0x2ecc71, // Green\n    H: 0x3498db, // Blue\n    J: 0x9b59b6, // Purple\n    K: 0xe91e63, // Pink (highest)\n    // Chromatic notes\n    R: 0xff6b6b, // Light Red (D#)\n    U: 0x4ecdc4, // Teal (G#)\n    I: 0x45b7d1, // Light Blue (Bb)\n    // Additional octave keys\n    A: 0x8e44ad, // Dark Purple (B3)\n    L: 0xe67e22, // Dark Orange (C5)\n    \";\": 0x16a085, // Dark Teal (D5)\n    \"'\": 0x27ae60, // Dark Green (E5)\n  } as Record<GameKey, number>,\n\n  // Valid game keys\n  VALID_KEYS: [\"S\", \"D\", \"F\", \"G\", \"H\", \"J\", \"K\", \"R\", \"U\", \"I\", \"A\", \"L\", \";\", \"'\", \"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\"] as readonly GameKey[],\n\n  // Error handling\n  ERROR_HANDLING: {\n    MANAGER_INIT_FAILED: \"Failed to initialize managers\",\n    INPUT_HANDLING_ERROR: \"Input handling error\",\n    PLATFORM_EXTENSION_ERROR: \"Platform extension error\",\n    CHARACTER_HEIGHT_ERROR: \"Character height update error\",\n    PLATFORM_CLEANUP_ERROR: \"Platform cleanup error\",\n    KEY_CHANGE_ERROR: \"Key change handling error\",\n    PLATFORM_START_ERROR: \"Failed to start platform\",\n    PLATFORM_END_ERROR: \"Failed to end platform\",\n  },\n} as const;\n","import { GAME_CONSTANTS, GameKey } from \"../config/GameConstants\";\n\n// Note frequencies for each game key (C major scale + chromatic notes)\nconst NOTE_FREQUENCIES: Record<GameKey, number> = {\n  S: 261.63, // C4\n  D: 293.66, // D4\n  F: 329.63, // E4\n  G: 349.23, // F4\n  H: 392.0, // G4\n  J: 440.0, // A4\n  K: 493.88, // B4\n  // Chromatic notes\n  R: 311.13, // D#4 (Eb4)\n  U: 415.30, // G#4 (Ab4)\n  I: 466.16, // Bb4\n  // LOWER OCTAVE NOTES (same note names for chord detection)\n  A: 246.94, // B3 (one octave below K)\n  L: 523.25, // C5 (one octave above S)\n  \";\": 587.33, // D5 (one octave above D)\n  \"'\": 659.25, // E5 (one octave above F)\n};\n\nexport interface IAudioManager {\n  initialize(): void;\n  playNote(key: GameKey): void;\n  stopNote(key: GameKey): void;\n  isAudioAvailable(): boolean;\n  updateLFORate(delta: number): void;\n  updateChorusDepth(delta: number): void;\n  updateDelayVolume(delta: number): void;\n  updateReverbAmount(delta: number): void;\n  switchWaveform(): void;\n  // GROUND MECHANICS AUDIO\n  playGroundC2(): void;\n  stopGroundC2(): void;\n  playDissonance(intensity: number): void;\n  stopDissonance(): void;\n}\n\nexport class AudioManager implements IAudioManager {\n  private audioContext: AudioContext | null = null;\n  private isInitialized: boolean = false;\n  private audioAvailable: boolean = false;\n  \n  // SYNTHESIS PARAMETERS\n  private lfoRate: number = 2.0; // Hz - vibrato speed\n  private chorusDepth: number = 0.1; // 0-1 - detuning amount\n  private delayTime: number = 0.25; // seconds - FIXED delay time\n  private delayVolume: number = 0.3; // 0-1 - delay wet level\n  private reverbAmount: number = 0.3; // 0-1 - reverb wet/dry mix\n  private distortionAmount: number = 0.2; // 0-1 - wave shaping amount\n  private currentWaveform: OscillatorType = \"sawtooth\"; // CURRENT WAVEFORM\n  \n  // SUSTAIN SYSTEM\n  private activeNotes: Map<GameKey, {\n    oscillators: OscillatorNode[];\n    gainNode: GainNode;\n    isSustaining: boolean;\n  }> = new Map();\n  \n  // GROUND MECHANICS AUDIO\n  private groundC2Oscillators: OscillatorNode[] = [];\n  private groundC2Gain: GainNode | null = null;\n  private dissonanceOscillator: OscillatorNode | null = null;\n  private dissonanceGain: GainNode | null = null;\n\n  initialize(): void {\n    try {\n      // Initialize Web Audio API context\n      this.audioContext = new (window.AudioContext ||\n        (window as unknown as { webkitAudioContext: typeof AudioContext })\n          .webkitAudioContext)();\n      this.audioAvailable = true;\n      this.isInitialized = true;\n      // AudioManager initialized successfully\n    } catch (error) {\n      console.warn(\"Web Audio API not available:\", error);\n      this.audioAvailable = false;\n      this.isInitialized = true;\n    }\n  }\n\n  playNote(key: GameKey): void {\n    if (!this.isInitialized) {\n      console.warn(\"AudioManager not initialized\");\n      return;\n    }\n\n    if (!this.audioAvailable || !this.audioContext) {\n      // Graceful degradation - audio not available\n      return;\n    }\n\n    const frequency = NOTE_FREQUENCIES[key];\n    if (!frequency) {\n      console.warn(`Unknown key: ${key}`);\n      return;\n    }\n\n    // IF NOTE IS ALREADY PLAYING, DON'T START ANOTHER\n    if (this.activeNotes.has(key)) {\n      return;\n    }\n\n    try {\n      this.startSustainedNote(key, frequency);\n    } catch (error) {\n      console.warn(\"Failed to play note:\", error);\n    }\n  }\n\n  stopNote(key: GameKey): void {\n    const activeNote = this.activeNotes.get(key);\n    if (activeNote) {\n      // FADE OUT GRACEFULLY\n      const now = this.audioContext!.currentTime;\n      activeNote.gainNode.gain.exponentialRampToValueAtTime(0.001, now + 0.1);\n      \n      // STOP ALL OSCILLATORS AFTER FADE\n      setTimeout(() => {\n        activeNote.oscillators.forEach(osc => {\n          try {\n            osc.stop();\n            osc.disconnect();\n          } catch (e) {\n            // Oscillator might already be stopped\n          }\n        });\n        activeNote.gainNode.disconnect();\n        this.activeNotes.delete(key);\n      }, 100);\n    }\n  }\n\n  isAudioAvailable(): boolean {\n    return this.audioAvailable;\n  }\n\n  // ARROW KEY CONTROLS FOR SYNTHESIS PARAMETERS\n  updateLFORate(delta: number): void {\n    this.lfoRate = Math.max(0.1, Math.min(10, this.lfoRate + delta));\n    console.log(`LFO Rate: ${this.lfoRate.toFixed(1)} Hz`);\n  }\n\n  updateChorusDepth(delta: number): void {\n    this.chorusDepth = Math.max(0, Math.min(1, this.chorusDepth + delta));\n    console.log(`Chorus Depth: ${(this.chorusDepth * 100).toFixed(0)}%`);\n  }\n\n  updateDelayVolume(delta: number): void {\n    this.delayVolume = Math.max(0, Math.min(1, this.delayVolume + delta));\n    console.log(`Delay Volume: ${(this.delayVolume * 100).toFixed(0)}%`);\n  }\n\n  updateReverbAmount(delta: number): void {\n    this.reverbAmount = Math.max(0, Math.min(1, this.reverbAmount + delta));\n    console.log(`Reverb Amount: ${(this.reverbAmount * 100).toFixed(0)}%`);\n  }\n\n  switchWaveform(): void {\n    const waveforms: OscillatorType[] = [\"sawtooth\", \"square\", \"triangle\", \"sine\"];\n    const currentIndex = waveforms.indexOf(this.currentWaveform);\n    const nextIndex = (currentIndex + 1) % waveforms.length;\n    this.currentWaveform = waveforms[nextIndex];\n    console.log(`🎵 Waveform switched to: ${this.currentWaveform}`);\n  }\n\n  // GETTERS FOR SYNTHESIS PARAMETERS\n  getLFORate(): number { return this.lfoRate; }\n  getChorusDepth(): number { return this.chorusDepth; }\n  getDelayVolume(): number { return this.delayVolume; }\n  getReverbAmount(): number { return this.reverbAmount; }\n  getDistortionAmount(): number { return this.distortionAmount; }\n  getCurrentWaveform(): OscillatorType { return this.currentWaveform; }\n\n  private startSustainedNote(key: GameKey, frequency: number): void {\n    if (!this.audioContext) return;\n\n    // CREATE MAIN OSCILLATOR WITH LFO VIBRATO\n    const mainOsc = this.audioContext.createOscillator();\n    const lfoOsc = this.audioContext.createOscillator();\n    const lfoGain = this.audioContext.createGain();\n    \n    // LFO SETUP FOR VIBRATO\n    lfoOsc.frequency.setValueAtTime(this.lfoRate, this.audioContext.currentTime);\n    lfoOsc.type = \"sine\";\n    lfoGain.gain.setValueAtTime(2, this.audioContext.currentTime); // REDUCED VIBRATO DEPTH\n    \n    lfoOsc.connect(lfoGain);\n    lfoGain.connect(mainOsc.frequency);\n    \n    // MAIN OSCILLATOR SETUP\n    mainOsc.frequency.setValueAtTime(frequency, this.audioContext.currentTime);\n    mainOsc.type = this.currentWaveform;\n    \n    // CREATE CHORUS EFFECT (MULTIPLE DETUNED OSCILLATORS)\n    const chorusOsc1 = this.audioContext.createOscillator();\n    const chorusOsc2 = this.audioContext.createOscillator();\n    const chorusGain1 = this.audioContext.createGain();\n    const chorusGain2 = this.audioContext.createGain();\n    \n    // DETUNE CHORUS OSCILLATORS\n    const detuneAmount = this.chorusDepth * 10; // REDUCED DETUNING\n    chorusOsc1.frequency.setValueAtTime(frequency + detuneAmount, this.audioContext.currentTime);\n    chorusOsc2.frequency.setValueAtTime(frequency - detuneAmount, this.audioContext.currentTime);\n    chorusOsc1.type = this.currentWaveform;\n    chorusOsc2.type = this.currentWaveform;\n    \n    // CHORUS VOLUME (QUIETER THAN MAIN)\n    chorusGain1.gain.setValueAtTime(0.2, this.audioContext.currentTime); // REDUCED\n    chorusGain2.gain.setValueAtTime(0.2, this.audioContext.currentTime); // REDUCED\n    \n    // CREATE DELAY\n    const delay = this.audioContext.createDelay();\n    const delayGain = this.audioContext.createGain();\n    const delayFeedback = this.audioContext.createGain();\n    \n    delay.delayTime.setValueAtTime(this.delayTime, this.audioContext.currentTime);\n    delayGain.gain.setValueAtTime(this.delayVolume, this.audioContext.currentTime); // DELAY WET LEVEL (CONTROLLABLE)\n    delayFeedback.gain.setValueAtTime(0.2, this.audioContext.currentTime); // FEEDBACK AMOUNT\n    \n    // CREATE DISTORTION\n    const distortion = this.audioContext.createWaveShaper();\n    const distortionCurve = this.createDistortionCurve(this.distortionAmount * 0.5); // REDUCED DISTORTION\n    distortion.curve = distortionCurve;\n    distortion.oversample = \"2x\"; // REDUCED OVERSAMPLING\n    \n    // CREATE MAIN GAIN NODE\n    const mainGain = this.audioContext.createGain();\n    \n    // CONNECT AUDIO GRAPH\n    mainOsc.connect(mainGain);\n    chorusOsc1.connect(chorusGain1).connect(mainGain);\n    chorusOsc2.connect(chorusGain2).connect(mainGain);\n    \n    // SPLIT SIGNAL: DRY AND WET (DELAY)\n    const dryGain = this.audioContext.createGain();\n    const wetGain = this.audioContext.createGain();\n    \n    dryGain.gain.setValueAtTime(1 - this.delayVolume, this.audioContext.currentTime); // DRY LEVEL (CONTROLLABLE)\n    wetGain.gain.setValueAtTime(this.delayVolume, this.audioContext.currentTime); // WET LEVEL (CONTROLLABLE)\n    \n    mainGain.connect(dryGain);\n    mainGain.connect(wetGain);\n    \n    // DELAY CHAIN\n    wetGain.connect(delay);\n    delay.connect(delayGain);\n    delay.connect(delayFeedback);\n    delayFeedback.connect(delay); // FEEDBACK LOOP\n    delayGain.connect(distortion);\n    \n    // COMBINE DRY AND WET\n    const outputGain = this.audioContext.createGain();\n    dryGain.connect(outputGain);\n    distortion.connect(outputGain);\n    outputGain.connect(this.audioContext.destination);\n    \n    // SET SUSTAIN VOLUME\n    const now = this.audioContext.currentTime;\n    mainGain.gain.setValueAtTime(0, now);\n    mainGain.gain.linearRampToValueAtTime(GAME_CONSTANTS.AUDIO.VOLUME * 0.5, now + 0.01); // QUICK ATTACK\n    \n    // START ALL OSCILLATORS\n    mainOsc.start(now);\n    lfoOsc.start(now);\n    chorusOsc1.start(now);\n    chorusOsc2.start(now);\n    \n    // STORE ACTIVE NOTE\n    this.activeNotes.set(key, {\n      oscillators: [mainOsc, lfoOsc, chorusOsc1, chorusOsc2],\n      gainNode: mainGain,\n      isSustaining: true\n    });\n  }\n\n  private playMusicalTone(frequency: number): void {\n    if (!this.audioContext) return;\n\n    // CREATE MAIN OSCILLATOR WITH LFO VIBRATO\n    const mainOsc = this.audioContext.createOscillator();\n    const lfoOsc = this.audioContext.createOscillator();\n    const lfoGain = this.audioContext.createGain();\n    \n    // LFO SETUP FOR VIBRATO\n    lfoOsc.frequency.setValueAtTime(this.lfoRate, this.audioContext.currentTime);\n    lfoOsc.type = \"sine\";\n    lfoGain.gain.setValueAtTime(5, this.audioContext.currentTime); // 5Hz vibrato depth\n    \n    lfoOsc.connect(lfoGain);\n    lfoGain.connect(mainOsc.frequency);\n    \n    // MAIN OSCILLATOR SETUP\n    mainOsc.frequency.setValueAtTime(frequency, this.audioContext.currentTime);\n    mainOsc.type = \"sawtooth\"; // RICHER SOUND THAN SINE\n    \n    // CREATE CHORUS EFFECT (MULTIPLE DETUNED OSCILLATORS)\n    const chorusOsc1 = this.audioContext.createOscillator();\n    const chorusOsc2 = this.audioContext.createOscillator();\n    const chorusGain1 = this.audioContext.createGain();\n    const chorusGain2 = this.audioContext.createGain();\n    \n    // DETUNE CHORUS OSCILLATORS\n    const detuneAmount = this.chorusDepth * 20; // 0-20 cents detuning\n    chorusOsc1.frequency.setValueAtTime(frequency + detuneAmount, this.audioContext.currentTime);\n    chorusOsc2.frequency.setValueAtTime(frequency - detuneAmount, this.audioContext.currentTime);\n    chorusOsc1.type = \"sawtooth\";\n    chorusOsc2.type = \"sawtooth\";\n    \n    // CHORUS VOLUME (QUIETER THAN MAIN)\n    chorusGain1.gain.setValueAtTime(0.3, this.audioContext.currentTime);\n    chorusGain2.gain.setValueAtTime(0.3, this.audioContext.currentTime);\n    \n    // CREATE FILTER\n    const filter = this.audioContext.createBiquadFilter();\n    filter.type = \"lowpass\";\n    filter.frequency.setValueAtTime(this.filterFrequency, this.audioContext.currentTime);\n    filter.Q.setValueAtTime(1, this.audioContext.currentTime); // RESONANCE\n    \n    // CREATE DISTORTION\n    const distortion = this.audioContext.createWaveShaper();\n    const distortionCurve = this.createDistortionCurve(this.distortionAmount);\n    distortion.curve = distortionCurve;\n    distortion.oversample = \"4x\";\n    \n    // CREATE REVERB USING DELAY (FIXED FEEDBACK)\n    const reverbDelay = this.audioContext.createDelay();\n    const reverbGain = this.audioContext.createGain();\n    const reverbFeedback = this.audioContext.createGain();\n    \n    reverbDelay.delayTime.setValueAtTime(0.1, this.audioContext.currentTime); // SHORTER DELAY\n    reverbGain.gain.setValueAtTime(this.reverbAmount * 0.3, this.audioContext.currentTime); // REDUCED GAIN\n    reverbFeedback.gain.setValueAtTime(0.1, this.audioContext.currentTime); // MUCH LOWER FEEDBACK\n    \n    // CREATE MAIN GAIN NODE\n    const mainGain = this.audioContext.createGain();\n    \n    // CONNECT AUDIO GRAPH\n    mainOsc.connect(mainGain);\n    chorusOsc1.connect(chorusGain1).connect(mainGain);\n    chorusOsc2.connect(chorusGain2).connect(mainGain);\n    \n    mainGain.connect(filter);\n    filter.connect(distortion);\n    \n    // SPLIT SIGNAL: DRY AND WET (REVERB)\n    const dryGain = this.audioContext.createGain();\n    const wetGain = this.audioContext.createGain();\n    \n    dryGain.gain.setValueAtTime(1 - this.reverbAmount, this.audioContext.currentTime);\n    wetGain.gain.setValueAtTime(this.reverbAmount, this.audioContext.currentTime);\n    \n    distortion.connect(dryGain);\n    distortion.connect(wetGain);\n    \n    // REVERB CHAIN (FIXED ROUTING)\n    wetGain.connect(reverbDelay);\n    reverbDelay.connect(reverbFeedback);\n    reverbFeedback.connect(reverbDelay); // CONTROLLED FEEDBACK\n    reverbDelay.connect(outputGain); // DIRECT TO OUTPUT, NO LOOP\n    \n    // COMBINE DRY AND WET\n    const outputGain = this.audioContext.createGain();\n    dryGain.connect(outputGain);\n    wetGain.connect(outputGain);\n    outputGain.connect(this.audioContext.destination);\n    \n    // ENVELOPE (ADSR)\n    const now = this.audioContext.currentTime;\n    const attackTime = 0.01;\n    const decayTime = 0.1;\n    const sustainLevel = 0.7;\n    const releaseTime = 0.3;\n    const noteDuration = GAME_CONSTANTS.AUDIO.NOTE_DURATION;\n    \n    // ATTACK\n    outputGain.gain.setValueAtTime(0, now);\n    outputGain.gain.linearRampToValueAtTime(GAME_CONSTANTS.AUDIO.VOLUME, now + attackTime);\n    \n    // DECAY\n    outputGain.gain.linearRampToValueAtTime(\n      GAME_CONSTANTS.AUDIO.VOLUME * sustainLevel, \n      now + attackTime + decayTime\n    );\n    \n    // RELEASE\n    outputGain.gain.exponentialRampToValueAtTime(\n      0.001, \n      now + noteDuration\n    );\n    \n    // START ALL OSCILLATORS\n    mainOsc.start(now);\n    lfoOsc.start(now);\n    chorusOsc1.start(now);\n    chorusOsc2.start(now);\n    \n    // STOP ALL OSCILLATORS\n    const stopTime = now + noteDuration;\n    mainOsc.stop(stopTime);\n    lfoOsc.stop(stopTime);\n    chorusOsc1.stop(stopTime);\n    chorusOsc2.stop(stopTime);\n  }\n  \n  private createDistortionCurve(amount: number): Float32Array {\n    const samples = 44100;\n    const curve = new Float32Array(samples);\n    const deg = Math.PI / 180;\n    \n    for (let i = 0; i < samples; i++) {\n      const x = (i * 2) / samples - 1;\n      curve[i] = ((3 + amount) * x * 20 * deg) / (Math.PI + amount * Math.abs(x));\n    }\n    \n    return curve;\n  }\n  \n  // GROUND MECHANICS AUDIO METHODS\n  playGroundC2(): void {\n    if (!this.audioContext || this.groundC2Oscillators.length > 0) return;\n    \n    // CREATE RICH PAD-LIKE C2 BASS WITH MULTIPLE OSCILLATORS\n    this.groundC2Gain = this.audioContext.createGain();\n    const now = this.audioContext.currentTime;\n    \n    // FUNDAMENTAL C2 (65.41 Hz) - SINE WAVE\n    const fundamental = this.audioContext.createOscillator();\n    fundamental.frequency.setValueAtTime(GAME_CONSTANTS.GAME.C2_FREQUENCY, now);\n    fundamental.type = \"sine\";\n    \n    // OCTAVE C3 (130.81 Hz) - SAWTOOTH FOR RICHNESS\n    const octave = this.audioContext.createOscillator();\n    octave.frequency.setValueAtTime(GAME_CONSTANTS.GAME.C2_FREQUENCY * 2, now);\n    octave.type = \"sawtooth\";\n    \n    // FIFTH G2 (98.00 Hz) - TRIANGLE FOR WARMTH\n    const fifth = this.audioContext.createOscillator();\n    fifth.frequency.setValueAtTime(GAME_CONSTANTS.GAME.C2_FREQUENCY * 1.5, now);\n    fifth.type = \"triangle\";\n    \n    // SUB-BASS C1 (32.70 Hz) - SINE FOR DEEP FOUNDATION\n    const subBass = this.audioContext.createOscillator();\n    subBass.frequency.setValueAtTime(GAME_CONSTANTS.GAME.C2_FREQUENCY * 0.5, now);\n    subBass.type = \"sine\";\n    \n    // CREATE INDIVIDUAL GAIN NODES FOR MIXING\n    const fundamentalGain = this.audioContext.createGain();\n    const octaveGain = this.audioContext.createGain();\n    const fifthGain = this.audioContext.createGain();\n    const subBassGain = this.audioContext.createGain();\n    \n    // SET VOLUME LEVELS FOR RICH PAD SOUND\n    fundamentalGain.gain.setValueAtTime(0.4, now); // FUNDAMENTAL\n    octaveGain.gain.setValueAtTime(0.2, now); // OCTAVE (QUIETER)\n    fifthGain.gain.setValueAtTime(0.3, now); // FIFTH\n    subBassGain.gain.setValueAtTime(0.3, now); // SUB-BASS\n    \n    // CONNECT OSCILLATORS TO THEIR GAINS\n    fundamental.connect(fundamentalGain);\n    octave.connect(octaveGain);\n    fifth.connect(fifthGain);\n    subBass.connect(subBassGain);\n    \n    // CONNECT ALL TO MAIN GAIN\n    fundamentalGain.connect(this.groundC2Gain);\n    octaveGain.connect(this.groundC2Gain);\n    fifthGain.connect(this.groundC2Gain);\n    subBassGain.connect(this.groundC2Gain);\n    \n    // CONNECT TO AUDIO CONTEXT\n    this.groundC2Gain.connect(this.audioContext.destination);\n    \n    // SET MAIN VOLUME (QUIET, SUSTAINED)\n    this.groundC2Gain.gain.setValueAtTime(0, now);\n    this.groundC2Gain.gain.linearRampToValueAtTime(GAME_CONSTANTS.AUDIO.VOLUME * 0.4, now + 0.8);\n    \n    // START ALL OSCILLATORS\n    fundamental.start(now);\n    octave.start(now);\n    fifth.start(now);\n    subBass.start(now);\n    \n    // STORE OSCILLATORS\n    this.groundC2Oscillators = [fundamental, octave, fifth, subBass];\n  }\n  \n  stopGroundC2(): void {\n    if (this.groundC2Oscillators.length > 0 && this.groundC2Gain) {\n      const now = this.audioContext!.currentTime;\n      this.groundC2Gain.gain.exponentialRampToValueAtTime(0.001, now + 0.3);\n      \n      setTimeout(() => {\n        try {\n          // STOP ALL OSCILLATORS\n          this.groundC2Oscillators.forEach(osc => {\n            osc.stop();\n            osc.disconnect();\n          });\n          this.groundC2Gain!.disconnect();\n        } catch (e) {\n          // Oscillators might already be stopped\n        }\n        this.groundC2Oscillators = [];\n        this.groundC2Gain = null;\n      }, 300);\n    }\n  }\n  \n  playDissonance(intensity: number): void {\n    if (!this.audioContext || this.dissonanceOscillator) return;\n    \n    // CREATE DISSONANT OSCILLATOR (TRITONE ABOVE C2)\n    this.dissonanceOscillator = this.audioContext.createOscillator();\n    this.dissonanceGain = this.audioContext.createGain();\n    \n    // TRITONE FREQUENCY (C2 + 6 semitones = F#2)\n    const dissonanceFreq = GAME_CONSTANTS.GAME.C2_FREQUENCY * Math.pow(2, 6/12);\n    this.dissonanceOscillator.frequency.setValueAtTime(dissonanceFreq, this.audioContext.currentTime);\n    this.dissonanceOscillator.type = \"sawtooth\"; // HARSH, DISSONANT\n    \n    // CONNECT TO AUDIO CONTEXT\n    this.dissonanceOscillator.connect(this.dissonanceGain);\n    this.dissonanceGain.connect(this.audioContext.destination);\n    \n    // SET VOLUME BASED ON INTENSITY\n    const now = this.audioContext.currentTime;\n    this.dissonanceGain.gain.setValueAtTime(0, now);\n    this.dissonanceGain.gain.linearRampToValueAtTime(intensity * GAME_CONSTANTS.AUDIO.VOLUME * 0.2, now + 0.3);\n    \n    // START OSCILLATOR\n    this.dissonanceOscillator.start(now);\n  }\n  \n  stopDissonance(): void {\n    if (this.dissonanceOscillator && this.dissonanceGain) {\n      const now = this.audioContext!.currentTime;\n      this.dissonanceGain.gain.exponentialRampToValueAtTime(0.001, now + 0.3);\n      \n      setTimeout(() => {\n        try {\n          this.dissonanceOscillator!.stop();\n          this.dissonanceOscillator!.disconnect();\n          this.dissonanceGain!.disconnect();\n        } catch (e) {\n          // Oscillator might already be stopped\n        }\n        this.dissonanceOscillator = null;\n        this.dissonanceGain = null;\n      }, 300);\n    }\n  }\n}\n","import { Scene } from \"phaser\";\nimport * as Phaser from \"phaser\";\nimport { GAME_CONSTANTS, GameKey } from \"../config/GameConstants\";\n\nexport interface IInputManager {\n  initialize(): void;\n  update(currentTime: number): { keyStateChanged: boolean };\n  getInputState(): { pressedKeys: Set<string> };\n  getArrowKeyState(): { up: boolean; down: boolean; left: boolean; right: boolean };\n}\n\nexport class InputManager implements IInputManager {\n  private scene: Scene;\n  private currentlyPressedKeys: Set<string> = new Set();\n  private previouslyPressedKeys: Set<string> = new Set();\n  private isInitialized: boolean = false;\n  private keyObjects: Map<string, Phaser.Input.Keyboard.Key> = new Map();\n  private arrowKeys: {\n    up: Phaser.Input.Keyboard.Key | null;\n    down: Phaser.Input.Keyboard.Key | null;\n    left: Phaser.Input.Keyboard.Key | null;\n    right: Phaser.Input.Keyboard.Key | null;\n  } = { up: null, down: null, left: null, right: null };\n\n  constructor(scene: Scene) {\n    this.scene = scene;\n  }\n\n  initialize(): void {\n    if (!this.scene.input.keyboard) {\n      console.warn(\"Keyboard input not available\");\n      return;\n    }\n\n    // Create key objects once during initialization\n    GAME_CONSTANTS.VALID_KEYS.forEach((key) => {\n      if (key === \";\") {\n        this.keyObjects.set(key, this.scene.input.keyboard!.addKey(Phaser.Input.Keyboard.KeyCodes.SEMICOLON));\n      } else if (key === \"'\") {\n        this.keyObjects.set(key, this.scene.input.keyboard!.addKey(Phaser.Input.Keyboard.KeyCodes.QUOTES));\n      } else {\n        this.keyObjects.set(key, this.scene.input.keyboard!.addKey(key));\n      }\n    });\n\n    // INITIALIZE ARROW KEYS FOR SYNTHESIS CONTROLS\n    this.arrowKeys.up = this.scene.input.keyboard!.addKey(Phaser.Input.Keyboard.KeyCodes.UP);\n    this.arrowKeys.down = this.scene.input.keyboard!.addKey(Phaser.Input.Keyboard.KeyCodes.DOWN);\n    this.arrowKeys.left = this.scene.input.keyboard!.addKey(Phaser.Input.Keyboard.KeyCodes.LEFT);\n    this.arrowKeys.right = this.scene.input.keyboard!.addKey(Phaser.Input.Keyboard.KeyCodes.RIGHT);\n\n    // ADDITIONAL SYNTHESIS CONTROLS (NUMBER KEYS)\n    this.keyObjects.set(\"1\", this.scene.input.keyboard!.addKey(Phaser.Input.Keyboard.KeyCodes.ONE));\n    this.keyObjects.set(\"2\", this.scene.input.keyboard!.addKey(Phaser.Input.Keyboard.KeyCodes.TWO));\n    this.keyObjects.set(\"3\", this.scene.input.keyboard!.addKey(Phaser.Input.Keyboard.KeyCodes.THREE));\n    this.keyObjects.set(\"4\", this.scene.input.keyboard!.addKey(Phaser.Input.Keyboard.KeyCodes.FOUR));\n    this.keyObjects.set(\"5\", this.scene.input.keyboard!.addKey(Phaser.Input.Keyboard.KeyCodes.FIVE));\n    this.keyObjects.set(\"6\", this.scene.input.keyboard!.addKey(Phaser.Input.Keyboard.KeyCodes.SIX));\n    this.keyObjects.set(\"7\", this.scene.input.keyboard!.addKey(Phaser.Input.Keyboard.KeyCodes.SEVEN));\n    this.keyObjects.set(\"8\", this.scene.input.keyboard!.addKey(Phaser.Input.Keyboard.KeyCodes.EIGHT));\n    this.keyObjects.set(\"0\", this.scene.input.keyboard!.addKey(Phaser.Input.Keyboard.KeyCodes.ZERO));\n\n    this.isInitialized = true;\n    // InputManager initialized successfully\n  }\n\n  update(_currentTime: number): { keyStateChanged: boolean } {\n    if (!this.isInitialized || !this.scene.input.keyboard) {\n      return { keyStateChanged: false };\n    }\n\n    // Store previous state\n    this.previouslyPressedKeys = new Set(this.currentlyPressedKeys);\n\n    // Clear current state\n    this.currentlyPressedKeys.clear();\n\n    // Check each valid game key using pre-created key objects\n    GAME_CONSTANTS.VALID_KEYS.forEach((key) => {\n      const keyObject = this.keyObjects.get(key);\n      if (keyObject && keyObject.isDown) {\n        this.currentlyPressedKeys.add(key);\n      }\n    });\n\n    // CHECK NUMBER KEYS FOR SYNTHESIS CONTROLS\n    [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"0\"].forEach((key) => {\n      const keyObject = this.keyObjects.get(key);\n      if (keyObject && keyObject.isDown) {\n        this.currentlyPressedKeys.add(key);\n      }\n    });\n\n    // Determine if key state changed\n    const keyStateChanged = this.hasKeyStateChanged();\n\n    return { keyStateChanged };\n  }\n\n  getInputState(): { pressedKeys: Set<string> } {\n    return {\n      pressedKeys: new Set(this.currentlyPressedKeys),\n    };\n  }\n\n  getArrowKeyState(): { up: boolean; down: boolean; left: boolean; right: boolean } {\n    return {\n      up: this.arrowKeys.up?.isDown || false,\n      down: this.arrowKeys.down?.isDown || false,\n      left: this.arrowKeys.left?.isDown || false,\n      right: this.arrowKeys.right?.isDown || false,\n    };\n  }\n\n  private hasKeyStateChanged(): boolean {\n    // Check if the sets are different\n    if (this.currentlyPressedKeys.size !== this.previouslyPressedKeys.size) {\n      return true;\n    }\n\n    // Check if any key in current set is not in previous set\n    for (const key of this.currentlyPressedKeys) {\n      if (!this.previouslyPressedKeys.has(key)) {\n        return true;\n      }\n    }\n\n    // Check if any key in previous set is not in current set\n    for (const key of this.previouslyPressedKeys) {\n      if (!this.currentlyPressedKeys.has(key)) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  // Helper method to check if a key is a valid game key\n  isValidGameKey(key: string): key is GameKey {\n    return GAME_CONSTANTS.VALID_KEYS.includes(key as GameKey);\n  }\n}\n","import { Scene } from \"phaser\";\nimport * as Phaser from \"phaser\";\nimport { GAME_CONSTANTS, GameKey } from \"../config/GameConstants\";\n\ninterface PlatformData {\n  rectangle: Phaser.GameObjects.Rectangle;\n  startX: number;\n  key: GameKey;\n  startTime: number;\n  isGrowing: boolean;\n  // VISUAL EFFECTS\n  glowEffect?: Phaser.GameObjects.Rectangle;\n  noteSymbol?: Phaser.GameObjects.Text;\n  pulseTween?: Phaser.Tweens.Tween;\n}\n\nexport interface IPlatformManager {\n  initialize(): void;\n  startNewPlatform(key: GameKey, startX: number): void;\n  endPlatform(key: GameKey): void;\n  extendActivePlatforms(characterX: number): void;\n  getHighestActiveKey(): GameKey | null;\n  hasActivePlatforms(): boolean;\n  cleanupOldPlatforms(characterX: number): void;\n  getActivePlatforms(): Map<string, PlatformData>;\n  getPlatformsGroup(): Phaser.GameObjects.Group;\n}\n\nexport class PlatformManager implements IPlatformManager {\n  private scene: Scene;\n  private activePlatforms: Map<string, PlatformData> = new Map();\n  private platformsGroup: Phaser.GameObjects.Group;\n  private isInitialized: boolean = false;\n\n  constructor(scene: Scene) {\n    this.scene = scene;\n    this.platformsGroup = this.scene.add.group();\n  }\n\n  initialize(): void {\n    this.isInitialized = true;\n    // PlatformManager initialized successfully\n  }\n\n  startNewPlatform(key: GameKey, startX: number): void {\n    if (!this.isInitialized) {\n      console.warn(\"PlatformManager not initialized\");\n      return;\n    }\n\n    // Don't create duplicate platforms for the same key\n    if (this.activePlatforms.has(key)) {\n      return;\n    }\n\n    const { height } = this.scene.cameras.main;\n    const platformY = height + GAME_CONSTANTS.LEVEL_HEIGHTS[key];\n    const platformColor = GAME_CONSTANTS.LEVEL_COLORS[key];\n\n    // CREATE GLOW EFFECT (BEHIND PLATFORM)\n    const glowEffect = this.scene.add.rectangle(\n      startX + GAME_CONSTANTS.PLATFORMS.AHEAD_OFFSET,\n      platformY,\n      GAME_CONSTANTS.PLATFORMS.MIN_LENGTH + 20, // SLIGHTLY LARGER\n      GAME_CONSTANTS.PLATFORMS.HEIGHT + 10, // SLIGHTLY TALLER\n      platformColor,\n      0.3 // TRANSPARENT\n    );\n    glowEffect.setStrokeStyle(3, platformColor, 0.6);\n\n    // CREATE MAIN PLATFORM WITH GRADIENT EFFECT\n    const platform = this.scene.add.rectangle(\n      startX + GAME_CONSTANTS.PLATFORMS.AHEAD_OFFSET,\n      platformY,\n      GAME_CONSTANTS.PLATFORMS.MIN_LENGTH,\n      GAME_CONSTANTS.PLATFORMS.HEIGHT,\n      platformColor,\n    );\n    \n    // ADD GRADIENT OVERLAY\n    const gradientOverlay = this.scene.add.rectangle(\n      startX + GAME_CONSTANTS.PLATFORMS.AHEAD_OFFSET,\n      platformY - 2, // SLIGHTLY ABOVE\n      GAME_CONSTANTS.PLATFORMS.MIN_LENGTH,\n      GAME_CONSTANTS.PLATFORMS.HEIGHT / 2,\n      0xFFFFFF, // WHITE GRADIENT\n      0.2\n    );\n    \n    // ADD MUSICAL NOTE SYMBOL\n    const noteSymbol = this.scene.add.text(\n      startX + GAME_CONSTANTS.PLATFORMS.AHEAD_OFFSET,\n      platformY,\n      this.getNoteSymbol(key),\n      {\n        fontSize: \"16px\",\n        color: \"#FFFFFF\",\n        fontFamily: \"Nabla, system-ui\",\n        stroke: \"#000000\",\n        strokeThickness: 2,\n      }\n    );\n    noteSymbol.setOrigin(0.5);\n\n    // Add to physics (optional, for future collision detection)\n    this.scene.physics.add.existing(platform, true); // true = static body\n\n    // CREATE PULSING ANIMATION\n    const pulseTween = this.scene.tweens.add({\n      targets: [platform, glowEffect, gradientOverlay],\n      scaleX: 1.05,\n      scaleY: 1.05,\n      duration: 1000,\n      yoyo: true,\n      repeat: -1,\n      ease: \"Sine.easeInOut\"\n    });\n\n    // Store platform data\n    const platformData: PlatformData = {\n      rectangle: platform,\n      startX: startX,\n      key: key,\n      startTime: this.scene.time.now,\n      isGrowing: true,\n      glowEffect: glowEffect,\n      noteSymbol: noteSymbol,\n      pulseTween: pulseTween,\n    };\n\n    this.activePlatforms.set(key, platformData);\n    this.platformsGroup.add(platform);\n    this.platformsGroup.add(glowEffect);\n    this.platformsGroup.add(gradientOverlay);\n    this.platformsGroup.add(noteSymbol);\n\n    // Platform created for key at specified height\n  }\n\n  private getNoteSymbol(key: GameKey): string {\n    const noteSymbols: Record<GameKey, string> = {\n      S: \"♪\", // C\n      D: \"♫\", // D  \n      F: \"♪\", // E\n      G: \"♫\", // F\n      H: \"♪\", // G\n      J: \"♫\", // A\n      K: \"♪\", // B\n      R: \"♯\", // D#\n      U: \"♯\", // G#\n      I: \"♭\", // Bb\n      A: \"♪\", // B3\n      L: \"♫\", // C5\n      \";\": \"♪\", // D5\n      \"'\": \"♫\", // E5\n    };\n    return noteSymbols[key] || \"♪\";\n  }\n\n  endPlatform(key: GameKey): void {\n    const platformData = this.activePlatforms.get(key);\n    if (!platformData) {\n      return;\n    }\n\n    // STOP PULSING ANIMATION\n    if (platformData.pulseTween) {\n      platformData.pulseTween.stop();\n    }\n\n    // FADE OUT VISUAL EFFECTS\n    this.scene.tweens.add({\n      targets: [platformData.rectangle, platformData.glowEffect, platformData.noteSymbol],\n      alpha: 0.3,\n      duration: 500,\n      ease: \"Power2\"\n    });\n\n    // Stop growing the platform\n    platformData.isGrowing = false;\n    \n    // Remove from active platforms but keep the visual platform\n    this.activePlatforms.delete(key);\n    // Platform ended for key\n  }\n\n  extendActivePlatforms(characterX: number): void {\n    this.activePlatforms.forEach((platformData, _key) => {\n      if (!platformData.isGrowing) return;\n      \n      const platform = platformData.rectangle;\n      \n      // Calculate how far the character has moved since platform creation\n      const distanceMoved = characterX - platformData.startX;\n      \n      // Platform should extend to keep up with character movement\n      const newWidth = Math.max(\n        GAME_CONSTANTS.PLATFORMS.MIN_LENGTH,\n        GAME_CONSTANTS.PLATFORMS.MIN_LENGTH + distanceMoved\n      );\n      \n      // Update platform size and position\n      const leftEdge = platform.x - platform.width / 2;\n      const newCenterX = leftEdge + newWidth / 2;\n      \n      platform.setSize(newWidth, platform.height);\n      platform.setPosition(newCenterX, platform.y);\n    });\n  }\n\n  getHighestActiveKey(): GameKey | null {\n    if (this.activePlatforms.size === 0) {\n      return null;\n    }\n\n    // Find the key with the highest level (lowest Y value)\n    let highestKey: GameKey | null = null;\n    let highestY = Number.POSITIVE_INFINITY;\n\n    this.activePlatforms.forEach((_platformData, key) => {\n      const levelHeight = GAME_CONSTANTS.LEVEL_HEIGHTS[key as GameKey];\n      if (levelHeight < highestY) {\n        highestY = levelHeight;\n        highestKey = key as GameKey;\n      }\n    });\n\n    return highestKey;\n  }\n\n  hasActivePlatforms(): boolean {\n    return this.activePlatforms.size > 0;\n  }\n\n  cleanupOldPlatforms(characterX: number): void {\n    const platformsToRemove: Phaser.GameObjects.Rectangle[] = [];\n\n    // Check all platforms in the group, not just active ones\n    this.platformsGroup.children.entries.forEach((platform) => {\n      const rect = platform as Phaser.GameObjects.Rectangle;\n      const platformRightEdge = rect.x + rect.width / 2;\n\n      // Remove platforms that are far behind the character\n      if (\n        platformRightEdge <\n        characterX - GAME_CONSTANTS.PLATFORMS.CLEANUP_DISTANCE\n      ) {\n        platformsToRemove.push(rect);\n      }\n    });\n\n    // Remove old platforms\n    platformsToRemove.forEach((platform) => {\n      this.platformsGroup.remove(platform);\n      platform.destroy();\n    });\n\n    // Old platforms cleaned up\n  }\n\n  getActivePlatforms(): Map<string, PlatformData> {\n    return new Map(this.activePlatforms);\n  }\n\n  getPlatformsGroup(): Phaser.GameObjects.Group {\n    return this.platformsGroup;\n  }\n\n  // Helper method to get level height for a key\n  getLevelHeight(key: GameKey): number {\n    return GAME_CONSTANTS.LEVEL_HEIGHTS[key];\n  }\n\n  // Helper method to get level color for a key\n  getLevelColor(key: GameKey): number {\n    return GAME_CONSTANTS.LEVEL_COLORS[key];\n  }\n}\n","// Note mapping system - maps keyboard keys to musical notes\nexport const NOTE_MAPPING = {\n  // Keyboard key -> Musical note\n  S: \"C\",  // C (Root)\n  D: \"D\",  // D (2nd)\n  F: \"E\",  // E (3rd)\n  G: \"F\",  // F (4th)\n  H: \"G\",  // G (5th)\n  J: \"A\",  // A (6th)\n  K: \"B\",  // B (7th)\n  // Chromatic notes\n  R: \"D#\", // D# (Sharp 2nd)\n  U: \"G#\", // G# (Sharp 5th)\n  I: \"Bb\", // Bb (Flat 7th)\n  // Additional octave keys (same note names for chord detection)\n  A: \"B\",  // B (same as K for chord detection)\n  L: \"C\",  // C (same as S for chord detection)\n  \";\": \"D\", // D (same as D for chord detection)\n  \"'\": \"E\", // E (same as F for chord detection)\n} as const;\n\n// Reverse mapping - Musical note -> Keyboard key\nexport const KEY_MAPPING = {\n  C: \"S\",\n  D: \"D\", \n  E: \"F\",\n  F: \"G\",\n  G: \"H\",\n  A: \"J\",\n  B: \"K\",\n  // Chromatic notes\n  \"D#\": \"R\",\n  \"G#\": \"U\",\n  \"Bb\": \"I\",\n} as const;\n\n// ALL COMMON CHORDS IN THE C MAJOR KEY (NOTES SORTED ALPHABETICALLY)\nexport const CHORD_DEFINITIONS = {\n    // ----------------------------\n    // TRIADS (3 NOTES) - 50 POINTS\n    // ----------------------------\n    \"C,E,G\": { name: \"C Major (I)\", points: 50 },\n    \"A,D,F\": { name: \"D Minor (ii)\", points: 50 },\n    \"B,E,G\": { name: \"E Minor (iii)\", points: 50 },\n    \"A,C,F\": { name: \"F Major (IV)\", points: 50 },\n    \"B,D,G\": { name: \"G Major (V)\", points: 50 },\n    \"A,C,E\": { name: \"A Minor (vi)\", points: 50 },\n    \"B,D,F\": { name: \"B Diminished (vii°)\", points: 50 },\n  \n    // ----------------------------\n    // SEVENTHS (4 NOTES) - 100 POINTS\n    // ----------------------------\n    \"B,C,E,G\": { name: \"C Major 7 (IΔ7)\", points: 100 },\n    \"A,C,D,F\": { name: \"D Minor 7 (ii7)\", points: 100 },\n    \"B,D,E,G\": { name: \"E Minor 7 (iii7)\", points: 100 },\n    \"A,C,E,F\": { name: \"F Major 7 (IVΔ7)\", points: 100 },\n    \"B,D,F,G\": { name: \"G Dominant 7 (V7)\", points: 100 },\n    \"A,C,E,G\": { name: \"A Minor 7 (vi7)\", points: 100 },\n    \"A,B,D,F\": { name: \"B Half-Diminished 7 (viiø7)\", points: 100 },\n  \n    // ----------------------------\n    // EXTENDED CHORDS - 150 POINTS\n    // ----------------------------\n    \"B,C,D,E,G\": { name: \"C Major 9\", points: 150 },\n    \"A,C,D,E,F\": { name: \"D Minor 9\", points: 150 },\n    \"A,B,D,F,G\": { name: \"G9 (Dominant 9)\", points: 150 },\n    \"A,B,C,E,G\": { name: \"A Minor 9\", points: 150 },\n  \n    // ----------------------------\n    // SUSPENDED CHORDS - 50 POINTS\n    // ----------------------------\n    \"C,F,G\": { name: \"Csus4\", points: 50 },\n    \"C,D,G\": { name: \"Csus2\", points: 50 },\n    \"A,D,G\": { name: \"Dsus4\", points: 50 },\n  \n    // ----------------------------\n    // ADD CHORDS - 75 POINTS\n    // ----------------------------\n    \"C,D,E,G\": { name: \"Cadd9\", points: 75 },\n  \n    // ----------------------------\n    // POWER CHORDS (5ths) - 25 POINTS\n    // ----------------------------\n    \"C,G\": { name: \"C5\", points: 25 },\n    \"A,D\": { name: \"D5\", points: 25 },\n    \"B,E\": { name: \"E5\", points: 25 },\n    \"C,F\": { name: \"F5\", points: 25 },\n    \"D,G\": { name: \"G5\", points: 25 },\n    \"A,E\": { name: \"A5\", points: 25 },\n    \"B,F\": { name: \"B5\", points: 25 },\n  } as const;\n  \n// C MAJOR + CHROMATIC EXTENSIONS (Bb, D#, G# INCLUDED, NOTES SORTED ALPHABETICALLY)\nexport const CHORD_DEFINITIONS_EXTENDED = {\n    // ----------------------------\n    // CHROMATIC TRIADS - 50 POINTS\n    // ----------------------------\n    \"A,C,D#\": { name: \"A Diminished (viio/iii)\", points: 50 },\n    \"A,C#,E\": { name: \"A Major (V/ii)\", points: 50 },\n    \"A,D,F#\": { name: \"D Major (V/V)\", points: 50 },\n    \"A#,C#,E\": { name: \"A# Diminished (viio/bII)\", points: 50 },\n    \"A#,C,D,F\": { name: \"F Minor (iv)\", points: 50 },\n    \"A#,F,G#\": { name: \"F Augmented (IV+)\", points: 50 },\n    \"A#,D,F\": { name: \"Bb Major (bVII)\", points: 50 },\n    \"A#,D,G\": { name: \"G Minor (v)\", points: 50 },\n    \"A#,D,G#\": { name: \"Ab Major (bVI)\", points: 50 },\n    \"B,D#,G#\": { name: \"G# Minor (iii/vi)\", points: 50 },\n    \"C,D#,G\": { name: \"C Minor (i)\", points: 50 },\n    \"A#,C,D#,G\": { name: \"C Minor 7 (i7)\", points: 100 },\n    \"C,E,G#\": { name: \"C Augmented (I+)\", points: 50 },\n    \"B,C,E,G#\": { name: \"C Augmented Major 7 (I+Δ7)\", points: 100 },\n    \"C#,E,G#\": { name: \"C# Diminished (viio/ii)\", points: 50 },\n    \"C#,F,G#\": { name: \"C# Minor (ii/ii)\", points: 50 },\n    \"B,C#,F,G#\": { name: \"C# Minor 7 (ii7/ii)\", points: 100 },\n    \"D,F,G#\": { name: \"D Augmented (II+)\", points: 50 },\n    \"A#,D#,G\": { name: \"Eb Minor (biii)\", points: 50 },\n    \"B,D#,G\": { name: \"D# Diminished\", points: 50 },\n    \"B,E,G#\": { name: \"E Major (III)\", points: 50 },\n    \"B,D,E,G#\": { name: \"E Dominant 7 (V7/vi)\", points: 100 },\n    \"C,F,G#\": { name: \"F Augmented (IV+)\", points: 50 },\n    \"A#,C,F\": { name: \"F Minor (iv)\", points: 50 },\n    \"A#,C,F,G#\": { name: \"F Augmented (IV+)\", points: 50 },\n\n  \n    // ----------------------------\n    // POWER CHORDS (5ths) - 25 POINTS\n    // ----------------------------\n    \"A#,F\": { name: \"Bb5 (bVII5)\", points: 25 },\n    \"A#,D#\": { name: \"Eb5 (bIII5)\", points: 25 },\n    \"D#,G#\": { name: \"Ab5 (bVI5)\", points: 25 },\n  } as const;\n  \n  \n\n// Helper functions\nexport function keysToNotes(keys: string[]): string[] {\n  return keys.map(key => NOTE_MAPPING[key as keyof typeof NOTE_MAPPING] || key);\n}\n\nexport function notesToKeys(notes: string[]): string[] {\n  return notes.map(note => KEY_MAPPING[note as keyof typeof KEY_MAPPING] || note);\n}\n\nexport function getChordFromNotes(notes: string[]): { name: string; points: number } | null {\n  const sortedNotes = [...notes].sort();\n  const noteString = sortedNotes.join(\",\");\n  \n  // Debug: Log what we're looking for\n  console.log(\"Looking for chord:\", noteString);\n  console.log(\"Available main chords:\", Object.keys(CHORD_DEFINITIONS).length);\n  console.log(\"Available extended chords:\", Object.keys(CHORD_DEFINITIONS_EXTENDED).length);\n  \n  // Check main chord definitions first\n  const mainChord = CHORD_DEFINITIONS[noteString as keyof typeof CHORD_DEFINITIONS];\n  if (mainChord) {\n    console.log(\"✅ Found in main chords:\", mainChord.name);\n    return mainChord;\n  }\n  \n  // Check extended chord definitions\n  const extendedChord = CHORD_DEFINITIONS_EXTENDED[noteString as keyof typeof CHORD_DEFINITIONS_EXTENDED];\n  if (extendedChord) {\n    console.log(\"✅ Found in extended chords:\", extendedChord.name);\n    return extendedChord;\n  }\n  \n  console.log(\"❌ No chord found for:\", noteString);\n  return null;\n}\n\nexport function getChordFromKeys(keys: string[]): { name: string; points: number } | null {\n  const sortedKeys = [...keys].sort();\n  const notes = keysToNotes(sortedKeys);\n  return getChordFromNotes(notes);\n}\n","import { Scene } from \"phaser\";\nimport { GAME_CONSTANTS, GameKey } from \"../config/GameConstants\";\nimport { getChordFromKeys, keysToNotes } from \"../config/NoteMapping\";\n\ninterface ChordData {\n  chordType: string;\n  basePoints: number;\n  accumulatedPoints: number;\n  startTime: number;\n  isComplete: boolean;\n}\n\nexport class ChordDetector {\n  private scene: Scene;\n  private currentChord: ChordData | null = null;\n\n  constructor(scene: Scene) {\n    this.scene = scene;\n  }\n\n  update(activeKeys: Set<string>): { points: number; chordName: string | null } {\n    const keyArray = Array.from(activeKeys).sort();\n    const notes = keysToNotes(keyArray);\n    const noteString = notes.join(\",\");\n    \n    // Debug: Log the key combination being checked\n    if (activeKeys.size > 1) {\n      console.log(\"Keys pressed:\", keyArray.join(\",\"));\n      console.log(\"Notes:\", notes.join(\",\"));\n      console.log(\"Looking for chord:\", noteString);\n    }\n    \n    const chordDef = getChordFromKeys(keyArray);\n\n    if (chordDef) {\n      console.log(\"✅ Chord detected:\", chordDef.name);\n      // New chord detected or same chord continuing\n      if (!this.currentChord || this.currentChord.chordType !== chordDef.name) {\n        this.currentChord = {\n          chordType: chordDef.name,\n          basePoints: chordDef.points,\n          accumulatedPoints: 0,\n          startTime: this.scene.time.now,\n          isComplete: false,\n        };\n      }\n\n      // Calculate points earned this frame (not total accumulated)\n      const elapsed = this.scene.time.now - this.currentChord.startTime;\n      const progress = Math.min(elapsed / GAME_CONSTANTS.CHORD_DETECTION.ACCUMULATION_TIME, 1);\n      const newAccumulatedPoints = Math.floor(this.currentChord.basePoints * progress);\n      const pointsThisFrame = newAccumulatedPoints - this.currentChord.accumulatedPoints;\n      \n      this.currentChord.accumulatedPoints = newAccumulatedPoints;\n\n      // Check if chord is complete\n      if (progress >= 1 && !this.currentChord.isComplete) {\n        this.currentChord.isComplete = true;\n      }\n\n      return { points: pointsThisFrame, chordName: this.currentChord.chordType };\n    } else {\n      // No valid chord detected\n      if (activeKeys.size > 1) {\n        console.log(\"❌ No chord found for:\", noteString);\n      }\n      this.currentChord = null;\n      return { points: 0, chordName: null };\n    }\n  }\n\n  getCurrentChord(): ChordData | null {\n    return this.currentChord;\n  }\n}\n","import * as Phaser from \"phaser\";\nimport { AudioManager } from \"../audio/AudioManager\";\n\nexport interface SynthControlConfig {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n}\n\nexport interface ScreenSize {\n  width: number;\n  height: number;\n  scaleFactor: number;\n  isMobile: boolean;\n  isTablet: boolean;\n  isDesktop: boolean;\n}\n\nexport class SynthControlPanel {\n  private scene: Phaser.Scene;\n  private audioManager: AudioManager;\n  private config: SynthControlConfig;\n  private screenSize: ScreenSize;\n  \n  // VISUAL COMPONENTS\n  private panelBackground!: Phaser.GameObjects.Graphics;\n  private titleText!: Phaser.GameObjects.Text;\n  \n  // LFO CONTROL\n  private lfoKnob!: Phaser.GameObjects.Graphics;\n  private lfoLabel!: Phaser.GameObjects.Text;\n  private lfoValue!: Phaser.GameObjects.Text;\n  private lfoPointer!: Phaser.GameObjects.Graphics;\n  \n  // CHORUS CONTROL\n  private chorusKnob!: Phaser.GameObjects.Graphics;\n  private chorusLabel!: Phaser.GameObjects.Text;\n  private chorusValue!: Phaser.GameObjects.Text;\n  private chorusPointer!: Phaser.GameObjects.Graphics;\n  \n  // DELAY CONTROL (SLIDER)\n  private delaySlider!: Phaser.GameObjects.Graphics;\n  private delayTrack!: Phaser.GameObjects.Graphics;\n  private delayHandle!: Phaser.GameObjects.Graphics;\n  private delayLabel!: Phaser.GameObjects.Text;\n  private delayValue!: Phaser.GameObjects.Text;\n  private delayLEDs!: Phaser.GameObjects.Graphics;\n  \n  // REVERB CONTROL\n  private reverbKnob!: Phaser.GameObjects.Graphics;\n  private reverbLabel!: Phaser.GameObjects.Text;\n  private reverbValue!: Phaser.GameObjects.Text;\n  private reverbPointer!: Phaser.GameObjects.Graphics;\n  \n  // WAVEFORM SELECTOR\n  private waveformSelector!: Phaser.GameObjects.Graphics;\n  private waveformLabel!: Phaser.GameObjects.Text;\n  private waveformValue!: Phaser.GameObjects.Text;\n  private waveformIcons!: Phaser.GameObjects.Text[];\n  \n  // ANIMATION STATE\n  private animationTweens: Phaser.Tweens.Tween[] = [];\n  \n  constructor(scene: Phaser.Scene, audioManager: AudioManager, config: SynthControlConfig) {\n    this.scene = scene;\n    this.audioManager = audioManager;\n    this.config = config;\n    this.screenSize = this.calculateScreenSize();\n  }\n  \n  create(): void {\n    this.updateScreenSize();\n    this.createPanelBackground();\n    this.createTitle();\n    this.createLFOControl();\n    this.createChorusControl();\n    this.createDelayControl();\n    this.createReverbControl();\n    this.createWaveformSelector();\n  }\n  \n  private createPanelBackground(): void {\n    const { x, y, width, height } = this.config;\n    \n    // MAIN PANEL BACKGROUND\n    this.panelBackground = this.scene.add.graphics();\n    this.panelBackground.setScrollFactor(0);\n    this.panelBackground.setDepth(100);\n    \n    // DARK SYNTH RACK BACKGROUND\n    this.panelBackground.fillStyle(0x2c3e50, 0.95);\n    this.panelBackground.fillRoundedRect(x, y, width, height, 8);\n    \n    // METALLIC BORDER\n    this.panelBackground.lineStyle(2, 0x7f8c8d, 1);\n    this.panelBackground.strokeRoundedRect(x, y, width, height, 8);\n    \n    // INNER HIGHLIGHT\n    this.panelBackground.lineStyle(1, 0x95a5a6, 0.5);\n    this.panelBackground.strokeRoundedRect(x + 1, y + 1, width - 2, height - 2, 6);\n  }\n  \n  private createTitle(): void {\n    const { x, y, width } = this.config;\n    \n    this.titleText = this.scene.add.text(x + width / 2, y + 15, \"🎛️ SYNTH CONTROLS\", {\n      fontSize: \"14px\",\n      color: \"#ecf0f1\",\n      fontFamily: \"Nabla, system-ui\",\n      stroke: \"#000000\",\n      strokeThickness: 1,\n    });\n    this.titleText.setOrigin(0.5, 0.5);\n    this.titleText.setScrollFactor(0);\n    this.titleText.setDepth(101);\n  }\n  \n  private createLFOControl(): void {\n    const { x, y } = this.config;\n    const knobX = x + 60;\n    const knobY = y + 45;\n    \n    // LFO KNOB BASE\n    this.lfoKnob = this.scene.add.graphics();\n    this.lfoKnob.setScrollFactor(0);\n    this.lfoKnob.setDepth(101);\n    \n    // KNOB BACKGROUND (YELLOW/AMBER)\n    this.lfoKnob.fillStyle(0xf39c12, 0.8);\n    this.lfoKnob.fillCircle(knobX, knobY, 20);\n    \n    // KNOB BORDER\n    this.lfoKnob.lineStyle(2, 0xe67e22, 1);\n    this.lfoKnob.strokeCircle(knobX, knobY, 20);\n    \n    // KNOB CENTER\n    this.lfoKnob.fillStyle(0x2c3e50, 1);\n    this.lfoKnob.fillCircle(knobX, knobY, 8);\n    \n    // LFO POINTER\n    this.lfoPointer = this.scene.add.graphics();\n    this.lfoPointer.setScrollFactor(0);\n    this.lfoPointer.setDepth(102);\n    \n    // LABEL\n    this.lfoLabel = this.scene.add.text(knobX, knobY + 35, \"LFO\", {\n      fontSize: \"10px\",\n      color: \"#f39c12\",\n      fontFamily: \"Nabla, system-ui\",\n      stroke: \"#000000\",\n      strokeThickness: 1,\n    });\n    this.lfoLabel.setOrigin(0.5, 0.5);\n    this.lfoLabel.setScrollFactor(0);\n    this.lfoLabel.setDepth(101);\n    \n    // VALUE DISPLAY\n    this.lfoValue = this.scene.add.text(knobX, knobY + 50, \"2.0Hz\", {\n      fontSize: \"8px\",\n      color: \"#ffffff\",\n      fontFamily: \"Nabla, system-ui\",\n      stroke: \"#000000\",\n      strokeThickness: 1,\n    });\n    this.lfoValue.setOrigin(0.5, 0.5);\n    this.lfoValue.setScrollFactor(0);\n    this.lfoValue.setDepth(101);\n  }\n  \n  private createChorusControl(): void {\n    const { x, y } = this.config;\n    const knobX = x + 140;\n    const knobY = y + 45;\n    \n    // CHORUS KNOB BASE\n    this.chorusKnob = this.scene.add.graphics();\n    this.chorusKnob.setScrollFactor(0);\n    this.chorusKnob.setDepth(101);\n    \n    // KNOB BACKGROUND (BLUE)\n    this.chorusKnob.fillStyle(0x3498db, 0.8);\n    this.chorusKnob.fillCircle(knobX, knobY, 20);\n    \n    // KNOB BORDER\n    this.chorusKnob.lineStyle(2, 0x2980b9, 1);\n    this.chorusKnob.strokeCircle(knobX, knobY, 20);\n    \n    // KNOB CENTER\n    this.chorusKnob.fillStyle(0x2c3e50, 1);\n    this.chorusKnob.fillCircle(knobX, knobY, 8);\n    \n    // CHORUS POINTER\n    this.chorusPointer = this.scene.add.graphics();\n    this.chorusPointer.setScrollFactor(0);\n    this.chorusPointer.setDepth(102);\n    \n    // LABEL\n    this.chorusLabel = this.scene.add.text(knobX, knobY + 35, \"CHORUS\", {\n      fontSize: \"10px\",\n      color: \"#3498db\",\n      fontFamily: \"Nabla, system-ui\",\n      stroke: \"#000000\",\n      strokeThickness: 1,\n    });\n    this.chorusLabel.setOrigin(0.5, 0.5);\n    this.chorusLabel.setScrollFactor(0);\n    this.chorusLabel.setDepth(101);\n    \n    // VALUE DISPLAY\n    this.chorusValue = this.scene.add.text(knobX, knobY + 50, \"10%\", {\n      fontSize: \"8px\",\n      color: \"#ffffff\",\n      fontFamily: \"Nabla, system-ui\",\n      stroke: \"#000000\",\n      strokeThickness: 1,\n    });\n    this.chorusValue.setOrigin(0.5, 0.5);\n    this.chorusValue.setScrollFactor(0);\n    this.chorusValue.setDepth(101);\n  }\n  \n  private createDelayControl(): void {\n    const { x, y } = this.config;\n    const sliderX = x + 220;\n    const sliderY = y + 35;\n    \n    // DELAY SLIDER TRACK\n    this.delayTrack = this.scene.add.graphics();\n    this.delayTrack.setScrollFactor(0);\n    this.delayTrack.setDepth(101);\n    \n    // SLIDER TRACK BACKGROUND\n    this.delayTrack.fillStyle(0x34495e, 1);\n    this.delayTrack.fillRoundedRect(sliderX - 3, sliderY, 6, 50, 3);\n    \n    // SLIDER TRACK BORDER\n    this.delayTrack.lineStyle(1, 0x2c3e50, 1);\n    this.delayTrack.strokeRoundedRect(sliderX - 3, sliderY, 6, 50, 3);\n    \n    // DELAY LED STRIP\n    this.delayLEDs = this.scene.add.graphics();\n    this.delayLEDs.setScrollFactor(0);\n    this.delayLEDs.setDepth(101);\n    \n    // DELAY SLIDER HANDLE\n    this.delayHandle = this.scene.add.graphics();\n    this.delayHandle.setScrollFactor(0);\n    this.delayHandle.setDepth(102);\n    \n    // LABEL\n    this.delayLabel = this.scene.add.text(sliderX, sliderY + 60, \"DELAY\", {\n      fontSize: \"10px\",\n      color: \"#2ecc71\",\n      fontFamily: \"Nabla, system-ui\",\n      stroke: \"#000000\",\n      strokeThickness: 1,\n    });\n    this.delayLabel.setOrigin(0.5, 0.5);\n    this.delayLabel.setScrollFactor(0);\n    this.delayLabel.setDepth(101);\n    \n    // VALUE DISPLAY\n    this.delayValue = this.scene.add.text(sliderX, sliderY + 75, \"30%\", {\n      fontSize: \"8px\",\n      color: \"#ffffff\",\n      fontFamily: \"Nabla, system-ui\",\n      stroke: \"#000000\",\n      strokeThickness: 1,\n    });\n    this.delayValue.setOrigin(0.5, 0.5);\n    this.delayValue.setScrollFactor(0);\n    this.delayValue.setDepth(101);\n  }\n  \n  private createReverbControl(): void {\n    const { x, y } = this.config;\n    const knobX = x + 300;\n    const knobY = y + 45;\n    \n    // REVERB KNOB BASE\n    this.reverbKnob = this.scene.add.graphics();\n    this.reverbKnob.setScrollFactor(0);\n    this.reverbKnob.setDepth(101);\n    \n    // KNOB BACKGROUND (PURPLE)\n    this.reverbKnob.fillStyle(0x9b59b6, 0.8);\n    this.reverbKnob.fillCircle(knobX, knobY, 20);\n    \n    // KNOB BORDER\n    this.reverbKnob.lineStyle(2, 0x8e44ad, 1);\n    this.reverbKnob.strokeCircle(knobX, knobY, 20);\n    \n    // KNOB CENTER\n    this.reverbKnob.fillStyle(0x2c3e50, 1);\n    this.reverbKnob.fillCircle(knobX, knobY, 8);\n    \n    // REVERB POINTER\n    this.reverbPointer = this.scene.add.graphics();\n    this.reverbPointer.setScrollFactor(0);\n    this.reverbPointer.setDepth(102);\n    \n    // LABEL\n    this.reverbLabel = this.scene.add.text(knobX, knobY + 35, \"REVERB\", {\n      fontSize: \"10px\",\n      color: \"#9b59b6\",\n      fontFamily: \"Nabla, system-ui\",\n      stroke: \"#000000\",\n      strokeThickness: 1,\n    });\n    this.reverbLabel.setOrigin(0.5, 0.5);\n    this.reverbLabel.setScrollFactor(0);\n    this.reverbLabel.setDepth(101);\n    \n    // VALUE DISPLAY\n    this.reverbValue = this.scene.add.text(knobX, knobY + 50, \"30%\", {\n      fontSize: \"8px\",\n      color: \"#ffffff\",\n      fontFamily: \"Nabla, system-ui\",\n      stroke: \"#000000\",\n      strokeThickness: 1,\n    });\n    this.reverbValue.setOrigin(0.5, 0.5);\n    this.reverbValue.setScrollFactor(0);\n    this.reverbValue.setDepth(101);\n  }\n  \n  private createWaveformSelector(): void {\n    const { x, y } = this.config;\n    const selectorX = x + 380;\n    const selectorY = y + 45;\n    \n    // WAVEFORM SELECTOR BASE\n    this.waveformSelector = this.scene.add.graphics();\n    this.waveformSelector.setScrollFactor(0);\n    this.waveformSelector.setDepth(101);\n    \n    // SELECTOR BACKGROUND (ORANGE)\n    this.waveformSelector.fillStyle(0xf39c12, 0.8);\n    this.waveformSelector.fillCircle(selectorX, selectorY, 20);\n    \n    // SELECTOR BORDER\n    this.waveformSelector.lineStyle(2, 0xe67e22, 1);\n    this.waveformSelector.strokeCircle(selectorX, selectorY, 20);\n    \n    // SELECTOR CENTER\n    this.waveformSelector.fillStyle(0x2c3e50, 1);\n    this.waveformSelector.fillCircle(selectorX, selectorY, 8);\n    \n    // WAVEFORM ICONS\n    this.waveformIcons = [];\n    const waveforms = [\"⚡\", \"⬜\", \"△\", \"∿\"]; // SAWTOOTH, SQUARE, TRIANGLE, SINE\n    const waveformNames = [\"SAW\", \"SQR\", \"TRI\", \"SIN\"];\n    \n    waveforms.forEach((icon, index) => {\n      const iconText = this.scene.add.text(\n        selectorX + (index - 1.5) * 15, \n        selectorY + 25, \n        icon, \n        {\n          fontSize: \"8px\",\n          color: \"#f39c12\",\n          fontFamily: \"Nabla, system-ui\",\n        }\n      );\n      iconText.setOrigin(0.5, 0.5);\n      iconText.setScrollFactor(0);\n      iconText.setDepth(101);\n      this.waveformIcons.push(iconText);\n    });\n    \n    // LABEL\n    this.waveformLabel = this.scene.add.text(selectorX, selectorY + 35, \"WAVE\", {\n      fontSize: \"10px\",\n      color: \"#f39c12\",\n      fontFamily: \"Nabla, system-ui\",\n      stroke: \"#000000\",\n      strokeThickness: 1,\n    });\n    this.waveformLabel.setOrigin(0.5, 0.5);\n    this.waveformLabel.setScrollFactor(0);\n    this.waveformLabel.setDepth(101);\n    \n    // VALUE DISPLAY\n    this.waveformValue = this.scene.add.text(selectorX, selectorY + 50, \"SAW\", {\n      fontSize: \"8px\",\n      color: \"#ffffff\",\n      fontFamily: \"Nabla, system-ui\",\n      stroke: \"#000000\",\n      strokeThickness: 1,\n    });\n    this.waveformValue.setOrigin(0.5, 0.5);\n    this.waveformValue.setScrollFactor(0);\n    this.waveformValue.setDepth(101);\n  }\n  \n  update(): void {\n    // GET CURRENT AUDIO PARAMETERS\n    const lfoRate = this.audioManager.getLFORate();\n    const chorusDepth = this.audioManager.getChorusDepth();\n    const delayVolume = this.audioManager.getDelayVolume();\n    const reverbAmount = this.audioManager.getReverbAmount();\n    const waveform = this.audioManager.getCurrentWaveform();\n    \n    // UPDATE LFO KNOB\n    this.updateLFOKnob(lfoRate);\n    \n    // UPDATE CHORUS KNOB\n    this.updateChorusKnob(chorusDepth);\n    \n    // UPDATE DELAY SLIDER\n    this.updateDelaySlider(delayVolume);\n    \n    // UPDATE REVERB KNOB\n    this.updateReverbKnob(reverbAmount);\n    \n    // UPDATE WAVEFORM SELECTOR\n    this.updateWaveformSelector(waveform);\n  }\n  \n  private updateLFOKnob(rate: number): void {\n    const { x, y } = this.config;\n    const knobX = x + 60;\n    const knobY = y + 45;\n    \n    // CALCULATE ROTATION ANGLE (0-360 degrees)\n    const angle = (rate / 10) * 360; // 0-10 Hz maps to 0-360 degrees\n    const radians = (angle - 90) * (Math.PI / 180); // -90 to start at top\n    \n    // UPDATE POINTER\n    this.lfoPointer.clear();\n    this.lfoPointer.lineStyle(3, 0xffffff, 1);\n    this.lfoPointer.beginPath();\n    this.lfoPointer.moveTo(knobX, knobY);\n    this.lfoPointer.lineTo(\n      knobX + Math.cos(radians) * 15,\n      knobY + Math.sin(radians) * 15\n    );\n    this.lfoPointer.strokePath();\n    \n    // UPDATE VALUE DISPLAY\n    this.lfoValue.setText(`${rate.toFixed(1)}Hz`);\n  }\n  \n  private updateChorusKnob(depth: number): void {\n    const { x, y } = this.config;\n    const knobX = x + 140;\n    const knobY = y + 45;\n    \n    // CALCULATE ROTATION ANGLE (0-360 degrees)\n    const angle = depth * 360; // 0-1 maps to 0-360 degrees\n    const radians = (angle - 90) * (Math.PI / 180); // -90 to start at top\n    \n    // UPDATE POINTER\n    this.chorusPointer.clear();\n    this.chorusPointer.lineStyle(3, 0xffffff, 1);\n    this.chorusPointer.beginPath();\n    this.chorusPointer.moveTo(knobX, knobY);\n    this.chorusPointer.lineTo(\n      knobX + Math.cos(radians) * 15,\n      knobY + Math.sin(radians) * 15\n    );\n    this.chorusPointer.strokePath();\n    \n    // UPDATE VALUE DISPLAY\n    this.chorusValue.setText(`${(depth * 100).toFixed(0)}%`);\n  }\n  \n  private updateDelaySlider(volume: number): void {\n    const { x, y } = this.config;\n    const sliderX = x + 220;\n    const sliderY = y + 35;\n    \n    // CALCULATE HANDLE POSITION (0-1 maps to slider range)\n    const handleY = sliderY + (1 - volume) * 50; // Invert for visual (top = 100%)\n    \n    // UPDATE HANDLE\n    this.delayHandle.clear();\n    this.delayHandle.fillStyle(0x2ecc71, 1);\n    this.delayHandle.fillRoundedRect(sliderX - 6, handleY - 3, 12, 6, 3);\n    this.delayHandle.lineStyle(1, 0x27ae60, 1);\n    this.delayHandle.strokeRoundedRect(sliderX - 6, handleY - 3, 12, 6, 3);\n    \n    // UPDATE LED STRIP\n    this.delayLEDs.clear();\n    const ledCount = Math.floor(volume * 10); // 0-10 LEDs\n    for (let i = 0; i < ledCount; i++) {\n      const ledY = sliderY + 5 + i * 4;\n      this.delayLEDs.fillStyle(0x2ecc71, 0.8);\n      this.delayLEDs.fillRect(sliderX - 2, ledY, 4, 2);\n    }\n    \n    // UPDATE VALUE DISPLAY\n    this.delayValue.setText(`${(volume * 100).toFixed(0)}%`);\n  }\n  \n  private updateReverbKnob(amount: number): void {\n    const { x, y } = this.config;\n    const knobX = x + 300;\n    const knobY = y + 45;\n    \n    // CALCULATE ROTATION ANGLE (0-360 degrees)\n    const angle = amount * 360; // 0-1 maps to 0-360 degrees\n    const radians = (angle - 90) * (Math.PI / 180); // -90 to start at top\n    \n    // UPDATE POINTER\n    this.reverbPointer.clear();\n    this.reverbPointer.lineStyle(3, 0xffffff, 1);\n    this.reverbPointer.beginPath();\n    this.reverbPointer.moveTo(knobX, knobY);\n    this.reverbPointer.lineTo(\n      knobX + Math.cos(radians) * 15,\n      knobY + Math.sin(radians) * 15\n    );\n    this.reverbPointer.strokePath();\n    \n    // UPDATE VALUE DISPLAY\n    this.reverbValue.setText(`${(amount * 100).toFixed(0)}%`);\n  }\n  \n  private updateWaveformSelector(waveform: string): void {\n    const waveforms = [\"sawtooth\", \"square\", \"triangle\", \"sine\"];\n    const waveformNames = [\"SAW\", \"SQR\", \"TRI\", \"SIN\"];\n    const currentIndex = waveforms.indexOf(waveform);\n    \n    // UPDATE VALUE DISPLAY\n    if (currentIndex >= 0) {\n      this.waveformValue.setText(waveformNames[currentIndex]);\n    }\n    \n    // HIGHLIGHT CURRENT WAVEFORM ICON\n    this.waveformIcons.forEach((icon, index) => {\n      if (index === currentIndex) {\n        icon.setColor(\"#ffffff\");\n        icon.setScale(1.2);\n      } else {\n        icon.setColor(\"#f39c12\");\n        icon.setScale(1.0);\n      }\n    });\n  }\n  \n  destroy(): void {\n    // CLEAN UP ALL GRAPHICS OBJECTS\n    this.panelBackground?.destroy();\n    this.titleText?.destroy();\n    this.lfoKnob?.destroy();\n    this.lfoLabel?.destroy();\n    this.lfoValue?.destroy();\n    this.lfoPointer?.destroy();\n    this.chorusKnob?.destroy();\n    this.chorusLabel?.destroy();\n    this.chorusValue?.destroy();\n    this.chorusPointer?.destroy();\n    this.delaySlider?.destroy();\n    this.delayTrack?.destroy();\n    this.delayHandle?.destroy();\n    this.delayLabel?.destroy();\n    this.delayValue?.destroy();\n    this.delayLEDs?.destroy();\n    this.reverbKnob?.destroy();\n    this.reverbLabel?.destroy();\n    this.reverbValue?.destroy();\n    this.reverbPointer?.destroy();\n    this.waveformSelector?.destroy();\n    this.waveformLabel?.destroy();\n    this.waveformValue?.destroy();\n    this.waveformIcons?.forEach(icon => icon.destroy());\n    \n    // CLEAN UP ANIMATIONS\n    this.animationTweens.forEach(tween => tween.destroy());\n    this.animationTweens = [];\n  }\n  \n  // RESPONSIVE DESIGN METHODS\n  private calculateScreenSize(): ScreenSize {\n    const { width, height } = this.scene.scale;\n    const scaleFactor = Math.min(Math.min(width / 1024, height / 768), 1);\n    \n    return {\n      width,\n      height,\n      scaleFactor,\n      isMobile: width < 768,\n      isTablet: width >= 768 && width < 1024,\n      isDesktop: width >= 1024\n    };\n  }\n  \n  private updateScreenSize(): void {\n    this.screenSize = this.calculateScreenSize();\n  }\n  \n  updateLayout(): void {\n    this.updateScreenSize();\n    this.updatePanelLayout();\n    this.updateControlLayouts();\n  }\n  \n  private updatePanelLayout(): void {\n    const { width, height } = this.screenSize;\n    const { scaleFactor, isMobile, isTablet } = this.screenSize;\n    \n    // ADJUST PANEL SIZE BASED ON SCREEN SIZE\n    let panelWidth, panelHeight, panelX, panelY;\n    \n    if (isMobile) {\n      // MOBILE: COMPACT HORIZONTAL LAYOUT\n      panelWidth = Math.min(width - 24, 380);\n      panelHeight = 70;\n      panelX = 12;\n      panelY = 12;\n    } else if (isTablet) {\n      // TABLET: MEDIUM LAYOUT\n      panelWidth = Math.min(width - 24, 580);\n      panelHeight = 90;\n      panelX = 12;\n      panelY = 12;\n    } else {\n      // DESKTOP: FULL LAYOUT\n      panelWidth = Math.min(width - 24, 520);\n      panelHeight = 110;\n      panelX = 12;\n      panelY = 50;\n    }\n    \n    // UPDATE CONFIG\n    this.config = {\n      x: panelX,\n      y: panelY,\n      width: panelWidth,\n      height: panelHeight\n    };\n    \n    // UPDATE PANEL BACKGROUND\n    if (this.panelBackground) {\n      this.panelBackground.clear();\n      this.panelBackground.fillStyle(0x2c3e50, 0.95);\n      this.panelBackground.fillRoundedRect(panelX, panelY, panelWidth, panelHeight, 8);\n      this.panelBackground.lineStyle(2, 0x7f8c8d, 1);\n      this.panelBackground.strokeRoundedRect(panelX, panelY, panelWidth, panelHeight, 8);\n      this.panelBackground.lineStyle(1, 0x95a5a6, 0.5);\n      this.panelBackground.strokeRoundedRect(panelX + 1, panelY + 1, panelWidth - 2, panelHeight - 2, 6);\n    }\n    \n    // UPDATE TITLE\n    if (this.titleText) {\n      this.titleText.setPosition(panelX + panelWidth / 2, panelY + 15);\n      this.titleText.setScale(scaleFactor);\n    }\n  }\n  \n  private updateControlLayouts(): void {\n    const { scaleFactor, isMobile, isTablet } = this.screenSize;\n    const { x, y, width, height } = this.config;\n    \n    // CALCULATE CONTROL POSITIONS BASED ON SCREEN SIZE\n    let controlSpacing, controlY, knobSize, fontSize, labelFontSize, valueOffset;\n    \n    if (isMobile) {\n      // MOBILE: COMPACT LAYOUT\n      controlSpacing = (width - 40) / 5; // 5 controls with padding\n      controlY = y + 30;\n      knobSize = 14;\n      fontSize = 7;\n      labelFontSize = 9;\n      valueOffset = 20;\n    } else if (isTablet) {\n      // TABLET: MEDIUM LAYOUT\n      controlSpacing = (width - 60) / 5;\n      controlY = y + 40;\n      knobSize = 18;\n      fontSize = 8;\n      labelFontSize = 10;\n      valueOffset = 25;\n    } else {\n      // DESKTOP: FULL LAYOUT\n      controlSpacing = 90;\n      controlY = y + 50;\n      knobSize = 22;\n      fontSize = 9;\n      labelFontSize = 11;\n      valueOffset = 30;\n    }\n    \n    // UPDATE LFO CONTROL\n    this.updateControlLayout('lfo', x + 20 + controlSpacing * 0, controlY, knobSize, fontSize, labelFontSize, scaleFactor, valueOffset);\n    \n    // UPDATE CHORUS CONTROL\n    this.updateControlLayout('chorus', x + 20 + controlSpacing * 1, controlY, knobSize, fontSize, labelFontSize, scaleFactor, valueOffset);\n    \n    // UPDATE DELAY CONTROL\n    this.updateControlLayout('delay', x + 20 + controlSpacing * 2, controlY, knobSize, fontSize, labelFontSize, scaleFactor, valueOffset);\n    \n    // UPDATE REVERB CONTROL\n    this.updateControlLayout('reverb', x + 20 + controlSpacing * 3, controlY, knobSize, fontSize, labelFontSize, scaleFactor, valueOffset);\n    \n    // UPDATE WAVEFORM SELECTOR\n    this.updateControlLayout('waveform', x + 20 + controlSpacing * 4, controlY, knobSize, fontSize, labelFontSize, scaleFactor, valueOffset);\n  }\n  \n  private updateControlLayout(controlType: string, x: number, y: number, knobSize: number, fontSize: number, labelFontSize: number, scaleFactor: number, valueOffset: number): void {\n    // UPDATE KNOB SIZE AND POSITION\n    const knob = this.getControlKnob(controlType);\n    if (knob) {\n      knob.clear();\n      this.drawKnob(knob, x, y, knobSize, controlType);\n    }\n    \n    // UPDATE LABEL\n    const label = this.getControlLabel(controlType);\n    if (label) {\n      label.setPosition(x, y + knobSize + 12);\n      label.setFontSize(`${labelFontSize}px`);\n      label.setScale(scaleFactor);\n    }\n    \n    // UPDATE VALUE DISPLAY\n    const value = this.getControlValue(controlType);\n    if (value) {\n      value.setPosition(x, y + knobSize + valueOffset);\n      value.setFontSize(`${fontSize}px`);\n      value.setScale(scaleFactor);\n    }\n    \n    // UPDATE POINTER (for knobs)\n    if (controlType !== 'delay' && controlType !== 'waveform') {\n      const pointer = this.getControlPointer(controlType);\n      if (pointer) {\n        // Pointer will be updated in the main update method\n      }\n    }\n  }\n  \n  private drawKnob(graphics: Phaser.GameObjects.Graphics, x: number, y: number, size: number, controlType: string): void {\n    const colors = {\n      lfo: { fill: 0xf39c12, stroke: 0xe67e22 },\n      chorus: { fill: 0x3498db, stroke: 0x2980b9 },\n      delay: { fill: 0x2ecc71, stroke: 0x27ae60 },\n      reverb: { fill: 0x9b59b6, stroke: 0x8e44ad },\n      waveform: { fill: 0xf39c12, stroke: 0xe67e22 }\n    };\n    \n    const color = colors[controlType as keyof typeof colors];\n    \n    // KNOB BACKGROUND\n    graphics.fillStyle(color.fill, 0.8);\n    graphics.fillCircle(x, y, size);\n    \n    // KNOB BORDER\n    graphics.lineStyle(2, color.stroke, 1);\n    graphics.strokeCircle(x, y, size);\n    \n    // KNOB CENTER\n    graphics.fillStyle(0x2c3e50, 1);\n    graphics.fillCircle(x, y, size * 0.4);\n  }\n  \n  private getControlKnob(controlType: string): Phaser.GameObjects.Graphics | null {\n    switch (controlType) {\n      case 'lfo': return this.lfoKnob;\n      case 'chorus': return this.chorusKnob;\n      case 'delay': return this.delayTrack;\n      case 'reverb': return this.reverbKnob;\n      case 'waveform': return this.waveformSelector;\n      default: return null;\n    }\n  }\n  \n  private getControlLabel(controlType: string): Phaser.GameObjects.Text | null {\n    switch (controlType) {\n      case 'lfo': return this.lfoLabel;\n      case 'chorus': return this.chorusLabel;\n      case 'delay': return this.delayLabel;\n      case 'reverb': return this.reverbLabel;\n      case 'waveform': return this.waveformLabel;\n      default: return null;\n    }\n  }\n  \n  private getControlValue(controlType: string): Phaser.GameObjects.Text | null {\n    switch (controlType) {\n      case 'lfo': return this.lfoValue;\n      case 'chorus': return this.chorusValue;\n      case 'delay': return this.delayValue;\n      case 'reverb': return this.reverbValue;\n      case 'waveform': return this.waveformValue;\n      default: return null;\n    }\n  }\n  \n  private getControlPointer(controlType: string): Phaser.GameObjects.Graphics | null {\n    switch (controlType) {\n      case 'lfo': return this.lfoPointer;\n      case 'chorus': return this.chorusPointer;\n      case 'reverb': return this.reverbPointer;\n      default: return null;\n    }\n  }\n}\n","import { Scene } from \"phaser\";\nimport * as Phaser from \"phaser\";\nimport { AudioManager } from \"../audio/AudioManager\";\nimport { InputManager } from \"../input/InputManager\";\nimport { PlatformManager } from \"../platform/PlatformManager\";\nimport { ChordDetector } from \"../audio/ChordDetector\";\nimport { SynthControlPanel } from \"../ui/SynthControlPanel\";\nimport { GAME_CONSTANTS, GameKey } from \"../config/GameConstants\";\n\nexport class MuseRunnerGame extends Scene {\n  private character!: Phaser.GameObjects.Image;\n  private scoreText!: Phaser.GameObjects.Text;\n\n  // Game state\n  private isGameRunning: boolean = false;\n  private score: number = 0;\n  \n  // GROUND MECHANICS STATE\n  private isGrounded: boolean = false;\n  private groundStartTime: number = 0;\n  private lastScoreDecayTime: number = 0;\n  \n  // SYNTHESIS PARAMETER DISPLAY\n  private synthControlPanel!: SynthControlPanel;\n  \n  // FLOATING POINTS SYSTEM\n  private floatingPoints: Phaser.GameObjects.Text[] = [];\n  private floatingPointsFrameCount: number = 0;\n  \n  // CHORD DETECTION TRACKING\n  private lastDetectedChord: string | null = null;\n  \n  // MATHEMATICAL VISUAL BOX\n  private mathVisualBox!: Phaser.GameObjects.Rectangle;\n  private chordDisplayText!: Phaser.GameObjects.Text;\n  private chordProgressBar!: Phaser.GameObjects.Rectangle;\n  \n  // GROUND VISUAL\n  private groundVisual!: Phaser.GameObjects.Rectangle;\n  \n  // MATHEMATICAL BACKGROUND\n  private mathBackground!: Phaser.GameObjects.Graphics;\n  private backgroundData: number[][] = [];\n\n  // Managers\n  private audioManager!: AudioManager;\n  private inputManager!: InputManager;\n  private platformManager!: PlatformManager;\n  private chordDetector!: ChordDetector;\n\n  constructor() {\n    super(\"MuseRunnerGame\");\n  }\n\n  async create(): Promise<void> {\n    const { width, height } = this.cameras.main;\n\n    // Initialize managers with error handling\n    try {\n      this.audioManager = new AudioManager();\n      this.inputManager = new InputManager(this);\n      this.platformManager = new PlatformManager(this);\n      this.chordDetector = new ChordDetector(this);\n\n      // Initialize managers with error handling\n      this.audioManager.initialize();\n      this.inputManager.initialize();\n      this.platformManager.initialize();\n\n      // All managers initialized successfully\n    } catch (error) {\n      console.error(GAME_CONSTANTS.ERROR_HANDLING.MANAGER_INIT_FAILED, error);\n      // Game can still continue with degraded functionality\n    }\n\n    // Create character using player.png image\n    this.character = this.add.image(\n      100,\n      height - 80,\n      \"player\"\n    );\n    this.character.setOrigin(0.5, 1); // BOTTOM CENTER ANCHOR - character's bottom touches platforms\n    this.character.setDepth(1000); // Ensure character appears above platforms\n    this.physics.add.existing(this.character);\n    const characterBody = this.character.body as Phaser.Physics.Arcade.Body;\n\n    // Set up physics for endless running - no collision needed\n    characterBody.setCollideWorldBounds(false);\n    characterBody.setDragX(0);\n    characterBody.setFrictionX(0);\n    characterBody.setGravityY(0); // No gravity - character rides platforms directly\n\n    // Create UI - make sure it's visible and doesn't scroll\n    this.scoreText = this.add.text(16, 16, \"Score: 0\", {\n      fontSize: \"24px\",\n      color: \"#ffffff\",\n      fontFamily: \"Nabla, system-ui\",\n      stroke: \"#000000\",\n      strokeThickness: 2,\n    });\n    this.scoreText.setScrollFactor(0); // Don't scroll with camera\n\n    // CREATE SYNTHESIS PARAMETER DISPLAY\n    this.synthControlPanel = new SynthControlPanel(this, this.audioManager, {\n      x: 16,\n      y: 50,\n      width: 500,\n      height: 100\n    });\n    this.synthControlPanel.create();\n\n    // CREATE MATHEMATICAL VISUAL BOX AT BOTTOM\n    this.createMathVisualBox();\n\n    // REMOVED: Instructions and key guide UI elements\n\n    // Controls info\n    this.add\n      .text(width - 16, 16, \"v0.0.4 | ESC: Menu | T: Restart\", {\n        fontSize: \"14px\",\n        color: \"#95a5a6\",\n        fontFamily: \"Nabla, system-ui\",\n      })\n      .setOrigin(1, 0)\n      .setScrollFactor(0); // Don't scroll with camera\n\n    // ESC key to return to menu\n    this.input.keyboard!.on(\"keydown-ESC\", () => {\n      this.scene.start(\"MainMenu\");\n    });\n\n    // T key to restart (R is now used for D# note)\n    this.input.keyboard!.on(\"keydown-T\", () => {\n      this.scene.restart();\n    });\n\n    // Start the game\n    this.isGameRunning = true;\n\n    // Camera follows character\n    this.cameras.main.startFollow(\n      this.character,\n      true,\n      GAME_CONSTANTS.GAME.CAMERA_FOLLOW_LERP_X,\n      GAME_CONSTANTS.GAME.CAMERA_FOLLOW_LERP_Y,\n    );\n    this.cameras.main.setDeadzone(\n      GAME_CONSTANTS.GAME.CAMERA_DEADZONE_X,\n      GAME_CONSTANTS.GAME.CAMERA_DEADZONE_Y,\n    );\n\n    // Reset game state\n    this.score = 0;\n\n    // ADD RESPONSIVE LAYOUT LISTENER\n    this.scale.on(\"resize\", (gameSize: Phaser.Structs.Size) => {\n      this.synthControlPanel.updateLayout();\n    });\n\n    // Don't start with any musical platform - wait for first key press\n  }\n\n  override update(): void {\n    if (!this.isGameRunning) return;\n\n    // Auto-run character forward - ALWAYS moving, never stops\n    const characterBody = this.character.body as Phaser.Physics.Arcade.Body;\n\n    // Force constant forward movement - override any physics that might stop it\n    characterBody.setVelocityX(GAME_CONSTANTS.CHARACTER.SPEED);\n    characterBody.setDragX(0); // No drag to slow down\n    characterBody.setFrictionX(0); // No friction from platforms\n\n    // Handle input for multiple simultaneous keys with error handling\n    try {\n      const { keyStateChanged } = this.inputManager.update(this.time.now);\n      const inputState = this.inputManager.getInputState();\n      const arrowKeys = this.inputManager.getArrowKeyState();\n\n      // SYNTHESIS CONTROLS (NUMBER KEYS)\n      if (inputState.pressedKeys.has(\"5\")) {\n        this.audioManager.updateLFORate(-0.1); // DECREASE LFO RATE\n        console.log(\"🎛️ Key 5 pressed - LFO Rate decreased\");\n      }\n      if (inputState.pressedKeys.has(\"6\")) {\n        this.audioManager.updateLFORate(0.1); // INCREASE LFO RATE\n        console.log(\"🎛️ Key 6 pressed - LFO Rate increased\");\n      }\n      if (inputState.pressedKeys.has(\"7\")) {\n        this.audioManager.updateChorusDepth(-0.05); // DECREASE CHORUS DEPTH\n        console.log(\"🎛️ Key 7 pressed - Chorus Depth decreased\");\n      }\n      if (inputState.pressedKeys.has(\"8\")) {\n        this.audioManager.updateChorusDepth(0.05); // INCREASE CHORUS DEPTH\n        console.log(\"🎛️ Key 8 pressed - Chorus Depth increased\");\n      }\n      if (inputState.pressedKeys.has(\"1\")) {\n        this.audioManager.updateDelayVolume(-0.05); // DECREASE DELAY VOLUME\n      }\n      if (inputState.pressedKeys.has(\"2\")) {\n        this.audioManager.updateDelayVolume(0.05); // INCREASE DELAY VOLUME\n      }\n      if (inputState.pressedKeys.has(\"3\")) {\n        this.audioManager.updateReverbAmount(-0.05); // DECREASE REVERB\n      }\n      if (inputState.pressedKeys.has(\"4\")) {\n        this.audioManager.updateReverbAmount(0.05); // INCREASE REVERB\n      }\n      // WAVEFORM SWITCHING (ONLY ON KEY PRESS, NOT HOLD)\n      if (keyStateChanged && inputState.pressedKeys.has(\"0\")) {\n        this.audioManager.switchWaveform(); // SWITCH WAVEFORM\n        console.log(\"🎛️ Key 0 pressed - Waveform switched\");\n      }\n\n      // UPDATE SYNTHESIS PARAMETER DISPLAY\n      this.updateSynthesisDisplay();\n\n      if (keyStateChanged) {\n        this.handleKeyChanges(inputState.pressedKeys);\n      }\n\n      // Update chord detection\n      const chordResult = this.chordDetector.update(inputState.pressedKeys);\n      \n      // RESET CHORD TRACKING IF NO CHORD DETECTED\n      if (!chordResult.chordName) {\n        this.lastDetectedChord = null;\n      }\n      \n      if (chordResult.points > 0) {\n        this.score += chordResult.points;\n        this.scoreText.setText(`Score: ${Math.floor(this.score)}`);\n        \n        // SHOW FLOATING POINTS FOR CHORD POINTS (FIXED SCREEN POSITION)\n        const currentChord = this.chordDetector.getCurrentChord();\n        if (currentChord) {\n          this.showFloatingPoints(currentChord.accumulatedPoints, this.cameras.main.width / 2, this.cameras.main.height / 2);\n        }\n        \n        // UPDATE MATH VISUAL BOX\n        this.updateMathVisualBox(chordResult.chordName, chordResult.points);\n        \n        // SHOW CHORD NAME AS FLOATING TEXT WHEN FIRST DETECTED\n        if (chordResult.chordName && chordResult.chordName !== this.lastDetectedChord) {\n          this.showChordNameFloating(chordResult.chordName);\n          this.lastDetectedChord = chordResult.chordName;\n        }\n      }\n    } catch (error) {\n      console.warn(GAME_CONSTANTS.ERROR_HANDLING.INPUT_HANDLING_ERROR, error);\n    }\n\n    // Extend all active platforms as character moves with error handling\n    try {\n      if (this.platformManager.hasActivePlatforms()) {\n        this.platformManager.extendActivePlatforms(this.character.x);\n      }\n    } catch (error) {\n      console.warn(GAME_CONSTANTS.ERROR_HANDLING.PLATFORM_EXTENSION_ERROR, error);\n    }\n\n    // Make character ride the highest active platform with error handling\n    try {\n      this.updateCharacterHeight();\n    } catch (error) {\n      console.warn(GAME_CONSTANTS.ERROR_HANDLING.CHARACTER_HEIGHT_ERROR, error);\n    }\n\n    // Character position tracking removed for performance\n    \n    // UPDATE MATHEMATICAL BACKGROUND\n    this.updateMathBackground();\n  }\n\n  private updateSynthesisDisplay(): void {\n    // UPDATE SYNTH CONTROL PANEL VISUALS\n    this.synthControlPanel.update();\n    \n    // UPDATE RESPONSIVE LAYOUT ON SCREEN RESIZE\n    this.synthControlPanel.updateLayout();\n\n    // Game over condition - only if character falls WAY off screen (make it more lenient)\n    if (\n      this.character.y >\n      this.cameras.main.height + GAME_CONSTANTS.GAME.OVER_FALL_DISTANCE\n    ) {\n      // Game over triggered - character fell too far\n      this.gameOver();\n    }\n\n    // Clean up old platforms through platform manager with error handling\n    try {\n      this.platformManager.cleanupOldPlatforms(this.character.x);\n    } catch (error) {\n      console.warn(GAME_CONSTANTS.ERROR_HANDLING.PLATFORM_CLEANUP_ERROR, error);\n    }\n  }\n\n  private handleKeyChanges(currentlyPressedKeys: Set<string>): void {\n    try {\n      const activePlatforms = this.platformManager.getActivePlatforms();\n\n      // Start new platforms for newly pressed keys\n      currentlyPressedKeys.forEach((key) => {\n        if (this.isValidGameKey(key) && !activePlatforms.has(key)) {\n          try {\n            this.platformManager.startNewPlatform(key, this.character.x);\n            this.audioManager.playNote(key);\n            // Platform started for key\n\n            // Visual feedback - scale character briefly\n            this.character.setScale(1.2);\n            this.time.delayedCall(\n              GAME_CONSTANTS.CHARACTER.VISUAL_FEEDBACK_DURATION,\n              () => {\n                this.character.setScale(1.0); // Back to normal size\n              },\n            );\n\n            this.score += GAME_CONSTANTS.GAME.SCORE_PER_PLATFORM;\n            this.scoreText.setText(`Score: ${Math.floor(this.score)}`);\n            \n            // SHOW FLOATING POINTS FOR PLATFORM CREATION (FIXED SCREEN POSITION)\n            this.showFloatingPoints(GAME_CONSTANTS.GAME.SCORE_PER_PLATFORM, this.cameras.main.width / 2, this.cameras.main.height / 2);\n            \n            // CREATE PLATFORM PARTICLE EFFECTS\n            this.createPlatformParticles(key, this.character.x);\n          } catch (error) {\n            console.warn(`${GAME_CONSTANTS.ERROR_HANDLING.PLATFORM_START_ERROR} for key ${key}:`, error);\n          }\n        }\n      });\n\n      // End platforms for released keys\n      activePlatforms.forEach((_platformData, key) => {\n        if (!currentlyPressedKeys.has(key)) {\n          try {\n            this.platformManager.endPlatform(key as GameKey);\n            this.audioManager.stopNote(key as GameKey); // STOP AUDIO WHEN KEY IS RELEASED\n            // Platform ended for key\n          } catch (error) {\n            console.warn(`${GAME_CONSTANTS.ERROR_HANDLING.PLATFORM_END_ERROR} for key ${key}:`, error);\n          }\n        }\n      });\n    } catch (error) {\n      console.error(GAME_CONSTANTS.ERROR_HANDLING.KEY_CHANGE_ERROR, error);\n    }\n  }\n\n  private isValidGameKey(key: string): key is GameKey {\n    return GAME_CONSTANTS.VALID_KEYS.includes(key as GameKey);\n  }\n\n  private updateCharacterHeight(): void {\n    const characterBody = this.character.body as Phaser.Physics.Arcade.Body;\n\n    // Get the highest active key to determine target height\n    const highestKey = this.platformManager.getHighestActiveKey();\n\n    if (highestKey) {\n      // CHARACTER IS ON A PLATFORM - NOT GROUNDED\n      if (this.isGrounded) {\n        this.handleLeaveGround();\n      }\n      \n      // Calculate target Y based on the highest active key\n      const { height } = this.cameras.main;\n      const targetY = height + GAME_CONSTANTS.LEVEL_HEIGHTS[highestKey];\n      const currentY = this.character.y;\n      const heightDiff = targetY - currentY;\n\n      // Very smooth transition with slower lerp\n      if (Math.abs(heightDiff) > 0.5) {\n        // Use slower lerp for ultra-smooth movement\n        const newY = Phaser.Math.Linear(\n          currentY,\n          targetY,\n          GAME_CONSTANTS.GAME.CHARACTER_HEIGHT_LERP_SPEED,\n        );\n        this.character.y = newY;\n        characterBody.setVelocityY(0); // Override physics velocity\n      } else {\n        // Close enough, lock to platform\n        this.character.y = targetY;\n        characterBody.setVelocityY(0);\n      }\n    } else {\n      // NO ACTIVE PLATFORMS - CHARACTER IS GROUNDED\n      const { height } = this.cameras.main;\n      const groundY = height - 20; // BELOW all notes (A is at -40, so ground at -20)\n\n      if (this.character.y < groundY) {\n        characterBody.setVelocityY(GAME_CONSTANTS.GAME.FALL_VELOCITY); // Fall down\n      } else {\n        this.character.y = groundY; // Hit ground\n        characterBody.setVelocityY(0);\n        \n        // HANDLE GROUND MECHANICS\n        if (!this.isGrounded) {\n          this.handleHitGround();\n        } else {\n          this.handleStayGrounded();\n        }\n      }\n    }\n  }\n\n  // GROUND MECHANICS HANDLERS\n  private handleHitGround(): void {\n    this.isGrounded = true;\n    this.groundStartTime = this.time.now;\n    this.lastScoreDecayTime = this.time.now;\n    \n    // START C2 BASE NOTE\n    this.audioManager.playGroundC2();\n    \n    // UPDATE CHARACTER VISUAL (DARKER)\n    this.character.setTint(0x666666);\n    \n    console.log(\"🎵 Character hit ground - C2 base note started\");\n  }\n  \n  private handleStayGrounded(): void {\n    const timeOnGround = this.time.now - this.groundStartTime;\n    \n    // SCORE DECAY AFTER GRACE PERIOD\n    if (timeOnGround > GAME_CONSTANTS.GAME.GROUND_GRACE_PERIOD) {\n      const timeSinceLastDecay = this.time.now - this.lastScoreDecayTime;\n      if (timeSinceLastDecay >= 1000) { // 1 second intervals\n        this.score -= GAME_CONSTANTS.GAME.SCORE_DECAY_RATE;\n        this.score = Math.max(0, this.score); // PREVENT NEGATIVE SCORE\n        this.scoreText.setText(`Score: ${Math.floor(this.score)}`);\n        this.lastScoreDecayTime = this.time.now;\n        \n        // SHOW NEGATIVE FLOATING POINTS\n        this.showFloatingPoints(-GAME_CONSTANTS.GAME.SCORE_DECAY_RATE, this.cameras.main.width / 2, this.cameras.main.height / 2);\n        \n        console.log(\"📉 Score decay: -1 point\");\n      }\n    }\n    \n    // DISSONANCE REMOVED\n  }\n  \n  private handleLeaveGround(): void {\n    this.isGrounded = false;\n    \n    // STOP GROUND AUDIO\n    this.audioManager.stopGroundC2();\n    \n    // RESTORE CHARACTER VISUAL (NORMAL COLOR)\n    this.character.clearTint();\n    \n    console.log(\"🎵 Character left ground - audio stopped\");\n  }\n  \n\n  private showFloatingPoints(points: number, x: number, y: number): void {\n    // CREATE FLOATING POINTS TEXT\n    const pointsText = this.add.text(x, y, `${points > 0 ? '+' : ''}${points}`, {\n      fontSize: \"24px\",\n      color: this.getPointsColor(points),\n      fontFamily: \"Nabla, system-ui\",\n      stroke: \"#000000\",\n      strokeThickness: 2,\n    });\n    pointsText.setOrigin(0.5);\n    pointsText.setScrollFactor(0);\n    \n    // ADD TO FLOATING POINTS ARRAY\n    this.floatingPoints.push(pointsText);\n    \n    // CREATE PARTICLE EFFECTS\n    this.createPointsParticles(x, y, points);\n    \n    // ANIMATE THE FLOATING TEXT\n    this.animateFloatingPoints(pointsText, points);\n  }\n  \n  private getPointsColor(points: number): string {\n    if (points < 0) return \"#E74C3C\"; // Red for negative points\n    if (points >= 100) return \"#FFD700\"; // Gold for 100+\n    if (points >= 50) return \"#9B59B6\";  // Purple for 50+\n    if (points >= 25) return \"#3498DB\";  // Blue for 25+\n    return \"#2ECC71\"; // Green for 10+\n  }\n  \n  private createPointsParticles(x: number, y: number, points: number): void {\n    // ONLY CREATE PARTICLES FOR FINAL CHORD COMPLETION (100+ points) OR PLATFORM CREATION\n    const shouldShowParticles = (points >= 100) || (points === 10); // FINAL CHORD COMPLETION OR PLATFORM CREATION\n    \n    if (!shouldShowParticles) {\n      return; // NO PARTICLES FOR CHORD ACCUMULATION\n    }\n    \n    // CREATE SPARKLE PARTICLES\n    const particleCount = Math.min(points / 10, 8); // More particles for higher points\n    \n    for (let i = 0; i < particleCount; i++) {\n      const sparkle = this.add.circle(x, y, 2, 0xFFFFFF, 0.8);\n      sparkle.setScrollFactor(0);\n      \n      // RANDOM DIRECTION AND SPEED\n      const angle = (Math.PI * 2 * i) / particleCount + Math.random() * 0.5;\n      const speed = 50 + Math.random() * 100;\n      \n      this.tweens.add({\n        targets: sparkle,\n        x: x + Math.cos(angle) * speed,\n        y: y + Math.sin(angle) * speed,\n        alpha: 0,\n        scale: 0,\n        duration: 800 + Math.random() * 400,\n        ease: \"Power2\",\n        onComplete: () => sparkle.destroy(),\n      });\n    }\n  }\n  \n  private animateFloatingPoints(pointsText: Phaser.GameObjects.Text, points: number): void {\n    let frameCount = 0;\n    const maxFrames = 60; // 1 second at 60fps\n    \n    // UPDATE FUNCTION FOR PULSING EFFECT\n    const updatePulse = () => {\n      frameCount++;\n      \n      // PULSE ONLY ON MULTIPLES OF 10 POINTS\n      if (points % 10 === 0) {\n        if (frameCount % 10 === 0) { // PULSE EVERY 10 FRAMES (1/2 PULSE TIME)\n          const pulseScale = 1.2 + (frameCount % 20 === 0 ? 0.3 : 0.1); // BIGGER PULSE EVERY 20TH FRAME\n          this.tweens.add({\n            targets: pointsText,\n            scaleX: pulseScale,\n            scaleY: pulseScale,\n            duration: 100,\n            yoyo: true,\n            ease: \"Power2\",\n          });\n        }\n      }\n      \n      if (frameCount < maxFrames) {\n        this.time.delayedCall(16, updatePulse); // ~60fps\n      }\n    };\n    \n    // START THE PULSING\n    updatePulse();\n    \n    // MAIN FLOATING ANIMATION\n    this.tweens.add({\n      targets: pointsText,\n      y: pointsText.y - 100,\n      alpha: 0,\n      rotation: Math.random() * 0.5 - 0.25, // SLIGHT ROTATION\n      duration: 1500,\n      ease: \"Power2\",\n      onComplete: () => {\n        pointsText.destroy();\n        // REMOVE FROM ARRAY\n        const index = this.floatingPoints.indexOf(pointsText);\n        if (index > -1) {\n          this.floatingPoints.splice(index, 1);\n        }\n      },\n    });\n  }\n\n  private createMathVisualBox(): void {\n    const { width, height } = this.cameras.main;\n    \n    // CREATE MATHEMATICAL VISUAL BOX (FULLY OPAQUE)\n    this.mathVisualBox = this.add.rectangle(\n      width / 2,\n      height - 60,\n      width - 40,\n      80,\n      0x2c3e50,\n      1.0 // FULLY OPAQUE\n    );\n    this.mathVisualBox.setScrollFactor(0);\n    this.mathVisualBox.setStrokeStyle(2, 0x3498db);\n    \n    // CREATE CHORD TEXT (HIDDEN - MATH BOX IS PURELY VISUAL)\n    this.chordDisplayText = this.add.text(\n      width / 2,\n      height - 80,\n      \"\",\n      {\n        fontSize: \"20px\",\n        color: \"#ecf0f1\",\n        fontFamily: \"Nabla, system-ui\",\n        stroke: \"#000000\",\n        strokeThickness: 1,\n      }\n    );\n    this.chordDisplayText.setOrigin(0.5);\n    this.chordDisplayText.setScrollFactor(0);\n    this.chordDisplayText.setVisible(false); // HIDDEN\n    \n    // CREATE PROGRESS BAR BACKGROUND\n    const progressBg = this.add.rectangle(\n      width / 2,\n      height - 40,\n      width - 60,\n      8,\n      0x34495e\n    );\n    progressBg.setScrollFactor(0);\n    \n    // CREATE PROGRESS BAR\n    this.chordProgressBar = this.add.rectangle(\n      width / 2 - (width - 60) / 2,\n      height - 40,\n      0,\n      8,\n      0x2ecc71\n    );\n    this.chordProgressBar.setOrigin(0, 0.5);\n    this.chordProgressBar.setScrollFactor(0);\n    \n    // CREATE MATHEMATICAL BACKGROUND\n    this.createMathBackground();\n  }\n\n\n  private createPlatformParticles(key: string, x: number): void {\n    const { height } = this.cameras.main;\n    const platformY = height + GAME_CONSTANTS.LEVEL_HEIGHTS[key as GameKey];\n    const platformColor = GAME_CONSTANTS.LEVEL_COLORS[key as GameKey];\n    \n    // CREATE MUSICAL PARTICLE EFFECTS\n    const particleCount = 8;\n    \n    for (let i = 0; i < particleCount; i++) {\n      // CREATE MUSICAL NOTE PARTICLES\n      const particle = this.add.text(x, platformY, \"♪\", {\n        fontSize: \"12px\",\n        color: `#${platformColor.toString(16).padStart(6, '0')}`,\n        fontFamily: \"Nabla, system-ui\",\n        stroke: \"#FFFFFF\",\n        strokeThickness: 1,\n      });\n      particle.setOrigin(0.5);\n      \n      // RANDOM DIRECTION AND SPEED\n      const angle = (Math.PI * 2 * i) / particleCount + Math.random() * 0.5;\n      const speed = 80 + Math.random() * 120;\n      const endX = x + Math.cos(angle) * speed;\n      const endY = platformY + Math.sin(angle) * speed;\n      \n      // ANIMATE PARTICLES\n      this.tweens.add({\n        targets: particle,\n        x: endX,\n        y: endY,\n        alpha: 0,\n        scale: 0.3,\n        rotation: Math.random() * Math.PI * 2,\n        duration: 800 + Math.random() * 400,\n        ease: \"Power2\",\n        onComplete: () => particle.destroy(),\n      });\n    }\n    \n    // CREATE SPARKLE EFFECT\n    const sparkleCount = 5;\n    for (let i = 0; i < sparkleCount; i++) {\n      const sparkle = this.add.circle(x, platformY, 2, platformColor, 0.8);\n      \n      const sparkleAngle = (Math.PI * 2 * i) / sparkleCount;\n      const sparkleSpeed = 60 + Math.random() * 80;\n      const sparkleEndX = x + Math.cos(sparkleAngle) * sparkleSpeed;\n      const sparkleEndY = platformY + Math.sin(sparkleAngle) * sparkleSpeed;\n      \n      this.tweens.add({\n        targets: sparkle,\n        x: sparkleEndX,\n        y: sparkleEndY,\n        alpha: 0,\n        scale: 0,\n        duration: 600 + Math.random() * 300,\n        ease: \"Power2\",\n        onComplete: () => sparkle.destroy(),\n      });\n    }\n  }\n\n  private updateMathVisualBox(chordName: string | null, points: number): void {\n    // MATH BOX IS PURELY MATHEMATICAL BACKGROUND - NO PROGRESS BAR OR TEXT\n    // The mathematical background updates automatically in updateMathBackground()\n  }\n\n  private showChordNameFloating(chordName: string): void {\n    // Create floating chord name text - position relative to camera viewport\n    const chordText = this.add.text(\n      this.cameras.main.width / 2,\n      this.cameras.main.height / 2 - 50, // ABOVE THE POINTS\n      chordName,\n      {\n        fontSize: \"28px\",\n        color: \"#f39c12\",\n        fontFamily: \"Nabla, system-ui\",\n        stroke: \"#000000\",\n        strokeThickness: 2,\n      }\n    );\n    chordText.setOrigin(0.5);\n    chordText.setScrollFactor(0);\n\n    // Animate the chord name floating up\n    this.tweens.add({\n      targets: chordText,\n      y: chordText.y - 80,\n      alpha: 0,\n      duration: 3000,\n      ease: \"Power2\",\n      onComplete: () => chordText.destroy(),\n    });\n  }\n\n  private showChordName(chordName: string, points: number): void {\n    // Remove any existing chord name text\n    this.children.list.forEach(child => {\n      if (child.name === 'chordName') {\n        child.destroy();\n      }\n    });\n\n    // Get current chord data to show accumulated points\n    const currentChord = this.chordDetector.getCurrentChord();\n    const accumulatedPoints = currentChord ? currentChord.accumulatedPoints : 0;\n\n    // Create new chord name text - position relative to camera viewport\n    const chordText = this.add.text(\n      this.cameras.main.width / 2,\n      100,\n      `${chordName} ${accumulatedPoints}/${currentChord?.basePoints || 0}`,\n      {\n        fontSize: \"32px\",\n        color: \"#f39c12\",\n        fontFamily: \"Nabla, system-ui\",\n        stroke: \"#000000\",\n        strokeThickness: 2,\n      }\n    );\n    chordText.setOrigin(0.5);\n    chordText.setScrollFactor(0);\n    chordText.name = 'chordName';\n\n    // Animate the chord name\n    this.tweens.add({\n      targets: chordText,\n      alpha: 0,\n      y: chordText.y - 50,\n      duration: 2000,\n      ease: \"Power2\",\n      onComplete: () => chordText.destroy(),\n    });\n  }\n\n  private gameOver(): void {\n    this.isGameRunning = false;\n\n    const { width, height } = this.cameras.main;\n\n    // Stop camera follow\n    this.cameras.main.stopFollow();\n\n    // Game over screen\n    const gameOverBg = this.add.rectangle(\n      this.cameras.main.scrollX + width / 2,\n      this.cameras.main.scrollY + height / 2,\n      width,\n      height,\n      0x000000,\n      0.8,\n    );\n    gameOverBg.setScrollFactor(0);\n\n    this.add\n      .text(\n        this.cameras.main.scrollX + width / 2,\n        this.cameras.main.scrollY + height / 2 - 80,\n        \"Game Over!\",\n        {\n          fontSize: \"48px\",\n          color: \"#e74c3c\",\n          fontFamily: \"Arial, sans-serif\",\n        },\n      )\n      .setOrigin(0.5)\n      .setScrollFactor(0);\n\n    this.add\n      .text(\n        this.cameras.main.scrollX + width / 2,\n        this.cameras.main.scrollY + height / 2 - 20,\n        `Final Score: ${Math.floor(this.score)}`,\n        {\n          fontSize: \"24px\",\n          color: \"#ffffff\",\n          fontFamily: \"Arial, sans-serif\",\n        },\n      )\n      .setOrigin(0.5)\n      .setScrollFactor(0);\n\n    const restartText = this.add\n      .text(\n        this.cameras.main.scrollX + width / 2,\n        this.cameras.main.scrollY + height / 2 + 30,\n        \"Press T to restart or ESC for menu\",\n        {\n          fontSize: \"18px\",\n          color: \"#bdc3c7\",\n          fontFamily: \"Arial, sans-serif\",\n        },\n      )\n      .setOrigin(0.5)\n      .setScrollFactor(0);\n\n    // Pulsing restart text\n    this.tweens.add({\n      targets: restartText,\n      alpha: 0.5,\n      duration: 1000,\n      yoyo: true,\n      repeat: -1,\n    });\n\n    // Send score to parent (Reddit)\n    if (window.parent) {\n      window.parent.postMessage(\n        {\n          type: \"GAME_OVER\",\n          data: { finalScore: Math.floor(this.score) },\n        },\n        \"*\",\n      );\n    }\n  }\n\n  private createMathBackground(): void {\n    const { width, height } = this.cameras.main;\n    \n    // CREATE GRAPHICS OBJECT FOR MATHEMATICAL BACKGROUND\n    this.mathBackground = this.add.graphics();\n    this.mathBackground.setScrollFactor(0);\n    this.mathBackground.setDepth(1); // ABOVE THE MATH BOX\n    \n    // INITIALIZE BACKGROUND DATA ARRAY\n    const boxWidth = width - 40;\n    const boxHeight = 80;\n    const boxX = 20;\n    const boxY = height - 100;\n    \n    // CREATE 2D ARRAY FOR BACKGROUND VALUES\n    this.backgroundData = [];\n    for (let y = 0; y < boxHeight; y++) {\n      this.backgroundData[y] = [];\n      for (let x = 0; x < boxWidth; x++) {\n        this.backgroundData[y][x] = 0;\n      }\n    }\n  }\n\n  private updateMathBackground(): void {\n    if (!this.mathBackground) return;\n    \n    const { width, height } = this.cameras.main;\n    const boxWidth = width - 40;\n    const boxHeight = 80;\n    const boxX = 20;\n    const boxY = height - 100;\n    \n    // GET AUDIO PARAMETERS\n    const lfoRate = this.audioManager.getLFORate();\n    const chorusDepth = this.audioManager.getChorusDepth();\n    const delayVolume = this.audioManager.getDelayVolume();\n    const reverbAmount = this.audioManager.getReverbAmount();\n    \n    // GET ACTIVE NOTES\n    const activeNotes = this.platformManager.getActivePlatforms();\n    const time = this.time.now * 0.001; // CONVERT TO SECONDS\n    \n    // CLEAR PREVIOUS GRAPHICS\n    this.mathBackground.clear();\n    \n    // CALCULATE MATHEMATICAL FUNCTION FOR EACH PIXEL\n    for (let y = 0; y < boxHeight; y++) {\n      for (let x = 0; x < boxWidth; x++) {\n        let value = 0;\n        \n        // BASE LFO WAVE (SINE) - INCREASED AMPLITUDE\n        value += Math.sin(x * lfoRate * 0.1 + time) * 0.8;\n        \n        // CHORUS WAVE (COSINE) - INCREASED AMPLITUDE\n        value += Math.cos(y * chorusDepth * 0.1 + time) * 0.6;\n        \n        // DELAY WAVE (SINE WITH PHASE SHIFT) - INCREASED AMPLITUDE\n        value += Math.sin((x + y) * delayVolume * 0.05 + time) * 0.4;\n        \n        // REVERB WAVE (TANGENT FOR COMPLEXITY) - INCREASED AMPLITUDE\n        value += Math.tan(x * reverbAmount * 0.02 + time) * 0.3;\n        \n        // ADD NOTE-SPECIFIC WAVES - INCREASED AMPLITUDE\n        activeNotes.forEach((note, key) => {\n          const frequency = this.getNoteFrequency(key);\n          if (frequency) {\n            value += Math.sin(x * frequency * 0.001 + time) * 0.5;\n            value += Math.cos(y * frequency * 0.001 + time) * 0.5;\n          }\n        });\n        \n        // NORMALIZE VALUE TO 0-1 RANGE\n        value = (value + 1) / 2;\n        \n        // CREATE VIBRANT COLOR SPECTRUM BASED ON VALUE\n        let color;\n        if (value < 0.25) {\n          // BLUE TO CYAN\n          color = Phaser.Display.Color.Interpolate.ColorWithColor(\n            { r: 0, g: 0, b: 255 }, // BLUE\n            { r: 0, g: 255, b: 255 }, // CYAN\n            100,\n            (value / 0.25) * 100\n          );\n        } else if (value < 0.5) {\n          // CYAN TO GREEN\n          color = Phaser.Display.Color.Interpolate.ColorWithColor(\n            { r: 0, g: 255, b: 255 }, // CYAN\n            { r: 0, g: 255, b: 0 }, // GREEN\n            100,\n            ((value - 0.25) / 0.25) * 100\n          );\n        } else if (value < 0.75) {\n          // GREEN TO YELLOW\n          color = Phaser.Display.Color.Interpolate.ColorWithColor(\n            { r: 0, g: 255, b: 0 }, // GREEN\n            { r: 255, g: 255, b: 0 }, // YELLOW\n            100,\n            ((value - 0.5) / 0.25) * 100\n          );\n        } else {\n          // YELLOW TO RED\n          color = Phaser.Display.Color.Interpolate.ColorWithColor(\n            { r: 255, g: 255, b: 0 }, // YELLOW\n            { r: 255, g: 0, b: 0 }, // RED\n            100,\n            ((value - 0.75) / 0.25) * 100\n          );\n        }\n        \n        // DRAW PIXEL WITH HIGHER OPACITY\n        this.mathBackground.fillStyle(\n          Phaser.Display.Color.GetColor(color.r, color.g, color.b),\n          0.7 // MUCH HIGHER TRANSPARENCY FOR VIBRANCY\n        );\n        this.mathBackground.fillRect(boxX + x, boxY + y, 1, 1);\n      }\n    }\n  }\n\n  private getNoteFrequency(key: string): number | null {\n    const NOTE_FREQUENCIES: Record<string, number> = {\n      S: 261.63, // C4\n      D: 293.66, // D4\n      F: 329.63, // E4\n      G: 349.23, // F4\n      H: 392.0, // G4\n      J: 440.0, // A4\n      K: 493.88, // B4\n      R: 311.13, // D#4\n      U: 415.30, // G#4\n      I: 466.16, // Bb4\n      A: 246.94, // B3\n      L: 523.25, // C5\n      \";\": 587.33, // D5\n      \"'\": 659.25, // E5\n    };\n    return NOTE_FREQUENCIES[key] || null;\n  }\n}\n","import { Scene, GameObjects } from \"phaser\";\n\nexport class MainMenu extends Scene {\n  private title: GameObjects.Text | null = null;\n  private subtitle: GameObjects.Text | null = null;\n  private instructions: GameObjects.Text | null = null;\n  private startText: GameObjects.Text | null = null;\n  private credits: GameObjects.Text | null = null;\n\n  constructor() {\n    super(\"MainMenu\");\n  }\n\n  init(): void {\n    this.title = null;\n    this.subtitle = null;\n    this.instructions = null;\n    this.startText = null;\n    this.credits = null;\n  }\n\n  create() {\n    this.refreshLayout();\n\n    // Re-calculate positions whenever the game canvas is resized\n    this.scale.on(\"resize\", () => this.refreshLayout());\n\n    // Start game on click or space\n    this.input.once(\"pointerdown\", () => {\n      this.scene.start(\"MuseRunnerGame\");\n    });\n\n    this.input.keyboard!.on(\"keydown-SPACE\", () => {\n      this.scene.start(\"MuseRunnerGame\");\n    });\n  }\n\n  private refreshLayout(): void {\n    const { width, height } = this.scale;\n\n    // Resize camera to new viewport\n    this.cameras.resize(width, height);\n\n    // Background\n    this.add.rectangle(width / 2, height / 2, width, height, 0x2c3e50);\n\n    // Scale factor for responsive design\n    const scaleFactor = Math.min(width / 1024, height / 768);\n\n    // Title\n    if (!this.title) {\n      this.title = this.add\n        .text(0, 0, \"🎵 Muse Runner 🏃‍♂️\", {\n          fontSize: \"48px\",\n          color: \"#ffffff\",\n          fontFamily: \"Nabla, system-ui\",\n        })\n        .setOrigin(0.5);\n    }\n    this.title.setPosition(width / 2, height / 3);\n    this.title.setScale(scaleFactor);\n\n    // Subtitle\n    if (!this.subtitle) {\n      this.subtitle = this.add\n        .text(0, 0, \"Rhythm Platformer\", {\n          fontSize: \"24px\",\n          color: \"#3498db\",\n          fontFamily: \"Nabla, system-ui\",\n        })\n        .setOrigin(0.5);\n    }\n    this.subtitle.setPosition(width / 2, height / 3 + 60 * scaleFactor);\n    this.subtitle.setScale(scaleFactor);\n\n    // Instructions\n    if (!this.instructions) {\n      this.instructions = this.add\n        .text(\n          0,\n          0,\n          \"Control your character by playing musical notes!\\n\\nPress S-D-F-G-H-J-K keys to create platforms\\nKeep your character from falling off the screen\",\n          {\n            fontSize: \"18px\",\n            color: \"#ecf0f1\",\n            fontFamily: \"Nabla, system-ui\",\n            align: \"center\",\n          },\n        )\n        .setOrigin(0.5);\n    }\n    this.instructions.setPosition(width / 2, height / 2);\n    this.instructions.setScale(scaleFactor);\n\n    // Start button text\n    if (!this.startText) {\n      this.startText = this.add\n        .text(0, 0, \"Click to Start or Press SPACE\", {\n          fontSize: \"24px\",\n          color: \"#2ecc71\",\n          fontFamily: \"Nabla, system-ui\",\n        })\n        .setOrigin(0.5);\n\n      // Pulsing effect\n      this.tweens.add({\n        targets: this.startText,\n        alpha: 0.5,\n        duration: 1000,\n        yoyo: true,\n        repeat: -1,\n      });\n    }\n    this.startText.setPosition(width / 2, height * 0.75);\n    this.startText.setScale(scaleFactor);\n\n    // Version info\n    if (!this.credits) {\n      this.credits = this.add\n        .text(\n          0,\n          0,\n          \"v0.0.4 - Built with Phaser.js for Reddit's Community Games Challenge\",\n          {\n            fontSize: \"14px\",\n            color: \"#95a5a6\",\n            fontFamily: \"Nabla, system-ui\",\n          },\n        )\n        .setOrigin(0.5);\n    }\n    this.credits.setPosition(width / 2, height - 40);\n    this.credits.setScale(scaleFactor * 0.8);\n  }\n}\n","import { Scene } from \"phaser\";\n\nexport class Preloader extends Scene {\n  constructor() {\n    super(\"Preloader\");\n  }\n\n  init() {\n    // REMOVED: Background image and progress bars that were persisting behind the game\n    // The game now loads cleanly without old UI elements\n  }\n\n  preload() {\n    //  Load the assets for the game - Replace with your own assets\n    this.load.setPath(\"assets\");\n\n    this.load.image(\"logo\", \"logo.png\");\n    this.load.image(\"player\", \"player.png\");\n    \n    // Preload the Nabla font to ensure it's available\n    this.load.setPath(\"assets/fonts\");\n    this.load.font(\"nabla\", \"nabla.ttf\");\n\n    // Assets loaded - spark texture removed to fix freezing issue\n  }\n\n  create() {\n    //  When all the assets have loaded, it's often worth creating global objects here that the rest of the game can use.\n    //  For example, you can define global animations here, so we can use them in other scenes.\n\n    //  Move to the MainMenu. You could also swap this for a Scene Transition, such as a camera fade.\n    this.scene.start(\"MainMenu\");\n  }\n}\n","import { Boot } from \"./scenes/Boot\";\nimport { GameOver } from \"./scenes/GameOver\";\nimport { MuseRunnerGame } from \"./scenes/MuseRunnerGame\";\nimport { MainMenu } from \"./scenes/MainMenu\";\nimport * as Phaser from \"phaser\";\nimport { AUTO, Game } from \"phaser\";\nimport { Preloader } from \"./scenes/Preloader\";\n\n//  Muse Runner - Rhythm Platformer Game Configuration\nconst config: Phaser.Types.Core.GameConfig = {\n  type: AUTO,\n  parent: \"game-container\",\n  backgroundColor: \"#2c3e50\",\n  physics: {\n    default: \"arcade\",\n    arcade: {\n      gravity: { x: 0, y: 0 }, // NO GRAVITY - character rides platforms directly\n      debug: false,\n    },\n  },\n  scale: {\n    mode: Phaser.Scale.RESIZE,\n    autoCenter: Phaser.Scale.CENTER_BOTH,\n    width: 1024,\n    height: 768,\n  },\n  scene: [Boot, Preloader, MainMenu, MuseRunnerGame, GameOver],\n};\n\nconst StartGame = (parent: string) => {\n  return new Game({ ...config, parent });\n};\n\nexport default StartGame;\n","import StartGame from \"./game/main\";\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  StartGame(\"game-container\");\n});\n"],"names":["Boot","Scene","constructor","super","preload","create","this","scene","start","GameOver","__publicField","camera","cameras","main","setBackgroundColor","background","add","image","setOrigin","setAlpha","gameOverText","text","fontFamily","fontSize","color","stroke","strokeThickness","align","updateLayout","scale","width","height","on","gameSize","input","once","resize","setDisplaySize","scaleFactor","Math","min","setPosition","setScale","GAME_CONSTANTS","CHARACTER","SPEED","WIDTH","HEIGHT","COLOR","VISUAL_FEEDBACK_COLOR","VISUAL_FEEDBACK_DURATION","PLATFORMS","EXTENSION_DISTANCE","AHEAD_OFFSET","CLEANUP_DISTANCE","MIN_LENGTH","GROWTH_RATE","AUDIO","NOTE_DURATION","ATTACK_TIME","VOLUME","GAME","OVER_FALL_DISTANCE","SCORE_PER_PLATFORM","GROUND_OFFSET","CHARACTER_HEIGHT_LERP_SPEED","FALL_VELOCITY","CAMERA_DEADZONE_X","CAMERA_DEADZONE_Y","CAMERA_FOLLOW_LERP_X","CAMERA_FOLLOW_LERP_Y","GROUND_GRACE_PERIOD","SCORE_DECAY_RATE","SCREEN_SHAKE_INTENSITY","C2_FREQUENCY","DISSONANCE_START_TIME","CHORD_DETECTION","ACCUMULATION_TIME","TRIAD_POINTS","SEVENTH_POINTS","POWER_CHORD_POINTS","LEVEL_HEIGHTS","S","R","D","F","G","H","J","K","U","I","A","L","LEVEL_COLORS","VALID_KEYS","ERROR_HANDLING","MANAGER_INIT_FAILED","INPUT_HANDLING_ERROR","PLATFORM_EXTENSION_ERROR","CHARACTER_HEIGHT_ERROR","PLATFORM_CLEANUP_ERROR","KEY_CHANGE_ERROR","PLATFORM_START_ERROR","PLATFORM_END_ERROR","NOTE_FREQUENCIES","AudioManager","Map","initialize","audioContext","window","AudioContext","webkitAudioContext","audioAvailable","isInitialized","error","console","warn","playNote","key","frequency","activeNotes","has","startSustainedNote","stopNote","activeNote","get","now","currentTime","gainNode","gain","exponentialRampToValueAtTime","setTimeout","oscillators","forEach","osc","stop","disconnect","e","delete","isAudioAvailable","updateLFORate","delta","lfoRate","max","log","toFixed","updateChorusDepth","chorusDepth","updateDelayVolume","delayVolume","updateReverbAmount","reverbAmount","switchWaveform","waveforms","nextIndex","indexOf","currentWaveform","length","getLFORate","getChorusDepth","getDelayVolume","getReverbAmount","getDistortionAmount","distortionAmount","getCurrentWaveform","mainOsc","createOscillator","lfoOsc","lfoGain","createGain","setValueAtTime","type","connect","chorusOsc1","chorusOsc2","chorusGain1","chorusGain2","detuneAmount","delay","createDelay","delayGain","delayFeedback","delayTime","distortion","createWaveShaper","distortionCurve","createDistortionCurve","curve","oversample","mainGain","dryGain","wetGain","outputGain","destination","linearRampToValueAtTime","set","isSustaining","playMusicalTone","filter","createBiquadFilter","filterFrequency","Q","reverbDelay","reverbGain","reverbFeedback","noteDuration","stopTime","amount","samples","Float32Array","deg","PI","i","x","abs","playGroundC2","groundC2Oscillators","groundC2Gain","fundamental","octave","fifth","subBass","fundamentalGain","octaveGain","fifthGain","subBassGain","stopGroundC2","playDissonance","intensity","dissonanceOscillator","dissonanceGain","dissonanceFreq","pow","stopDissonance","InputManager","Set","up","down","left","right","keyboard","keyObjects","addKey","Phaser.Input","Keyboard","KeyCodes","SEMICOLON","QUOTES","arrowKeys","UP","DOWN","LEFT","RIGHT","ONE","TWO","THREE","FOUR","FIVE","SIX","SEVEN","EIGHT","ZERO","update","_currentTime","previouslyPressedKeys","currentlyPressedKeys","clear","keyObject","isDown","keyStateChanged","hasKeyStateChanged","getInputState","pressedKeys","getArrowKeyState","_a","_b","_c","_d","size","isValidGameKey","includes","PlatformManager","platformsGroup","group","startNewPlatform","startX","activePlatforms","platformY","platformColor","glowEffect","rectangle","setStrokeStyle","platform","gradientOverlay","noteSymbol","getNoteSymbol","physics","existing","pulseTween","tweens","targets","scaleX","scaleY","duration","yoyo","repeat","ease","platformData","startTime","time","isGrowing","endPlatform","alpha","extendActivePlatforms","characterX","_key","distanceMoved","newWidth","newCenterX","setSize","y","getHighestActiveKey","highestKey","highestY","Number","POSITIVE_INFINITY","_platformData","levelHeight","hasActivePlatforms","cleanupOldPlatforms","platformsToRemove","children","entries","rect","push","remove","destroy","getActivePlatforms","getPlatformsGroup","getLevelHeight","getLevelColor","NOTE_MAPPING","CHORD_DEFINITIONS","name","points","CHORD_DEFINITIONS_EXTENDED","keysToNotes","keys","map","ChordDetector","activeKeys","keyArray","Array","from","sort","notes","noteString","join","chordDef","Object","mainChord","extendedChord","getChordFromNotes","currentChord","chordType","basePoints","accumulatedPoints","isComplete","elapsed","progress","newAccumulatedPoints","floor","pointsThisFrame","chordName","getCurrentChord","SynthControlPanel","audioManager","config","screenSize","calculateScreenSize","updateScreenSize","createPanelBackground","createTitle","createLFOControl","createChorusControl","createDelayControl","createReverbControl","createWaveformSelector","panelBackground","graphics","setScrollFactor","setDepth","fillStyle","fillRoundedRect","lineStyle","strokeRoundedRect","titleText","knobX","knobY","lfoKnob","fillCircle","strokeCircle","lfoPointer","lfoLabel","lfoValue","chorusKnob","chorusPointer","chorusLabel","chorusValue","sliderX","sliderY","delayTrack","delayLEDs","delayHandle","delayLabel","delayValue","reverbKnob","reverbPointer","reverbLabel","reverbValue","selectorX","selectorY","waveformSelector","waveformIcons","icon","index","iconText","waveformLabel","waveformValue","waveform","updateLFOKnob","updateChorusKnob","updateDelaySlider","updateReverbKnob","updateWaveformSelector","rate","radians","beginPath","moveTo","lineTo","cos","sin","strokePath","setText","depth","volume","handleY","ledCount","ledY","fillRect","currentIndex","setColor","_e","_f","_g","_h","_i","_j","_k","delaySlider","_l","_m","_n","_o","_p","_q","_r","_s","_t","_u","_v","_w","_x","animationTweens","tween","isMobile","isTablet","isDesktop","updatePanelLayout","updateControlLayouts","panelWidth","panelHeight","panelX","panelY","controlSpacing","controlY","knobSize","labelFontSize","valueOffset","updateControlLayout","controlType","knob","getControlKnob","drawKnob","label","getControlLabel","setFontSize","value","getControlValue","getControlPointer","lfo","fill","chorus","reverb","MuseRunnerGame","inputManager","platformManager","chordDetector","character","characterBody","body","setCollideWorldBounds","setDragX","setFrictionX","setGravityY","scoreText","synthControlPanel","createMathVisualBox","restart","isGameRunning","startFollow","setDeadzone","score","setVelocityX","inputState","updateSynthesisDisplay","handleKeyChanges","chordResult","lastDetectedChord","showFloatingPoints","updateMathVisualBox","showChordNameFloating","updateCharacterHeight","updateMathBackground","gameOver","delayedCall","createPlatformParticles","isGrounded","handleLeaveGround","targetY","currentY","heightDiff","newY","Phaser.Math","Linear","setVelocityY","groundY","handleStayGrounded","handleHitGround","groundStartTime","lastScoreDecayTime","setTint","clearTint","pointsText","getPointsColor","floatingPoints","createPointsParticles","animateFloatingPoints","particleCount","sparkle","circle","angle","random","speed","onComplete","frameCount","updatePulse","pulseScale","rotation","splice","mathVisualBox","chordDisplayText","setVisible","chordProgressBar","createMathBackground","particle","toString","padStart","endX","endY","sparkleAngle","sparkleSpeed","sparkleEndX","sparkleEndY","chordText","showChordName","list","child","stopFollow","scrollX","scrollY","restartText","parent","postMessage","data","finalScore","mathBackground","boxWidth","backgroundData","boxY","tan","note","getNoteFrequency","Phaser.Display","Color","Interpolate","ColorWithColor","r","g","b","GetColor","MainMenu","init","title","subtitle","instructions","startText","credits","refreshLayout","Preloader","load","setPath","font","AUTO","backgroundColor","default","arcade","gravity","debug","mode","Phaser.Scale","RESIZE","autoCenter","CENTER_BOTH","document","addEventListener","Game"],"mappings":"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"}